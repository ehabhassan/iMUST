MODULE FORTGRAPHER

!**********************************************************************
! BSD SOFTWARE LICENSE
!************************
! PERTAINS TO FORTGRAPHER
!
! COPYRIGHT(c) 2011-2012 EHAB ALI HASSAN:
!****************************************
! THIS CODE IS DEVELOPED BY: EHAB ALI HASSAN; EHAB@UTEXAS.COM
! RESEARCH ASSISTANT AT UNIVERSITY OF TEXAS AT AUSTIN, TEXAS, US.
! RESEARCH ASSISTANT AT AIN SHAMS UNIVERSITY, CAIRO, EGYPT.
!
! IT IS AN OPEN SOURCE CODE AND YOU ARE ALLOWED TO MAKE ALL REQUIRED CHANGES
! YOU MAY NEED TO THIS CODE BUT YOU HAVE TO SEND ME ALL YOU MODIFICATION AND
! MAKE THESE MODIFICATIONS OPEN FOR ALL OTHERS TO USE FOR FREE.
!
! YOU ARE NOT ALLOWED TO CHANGE THE NAME OF THIS MODULE OR ANY OF ITS
! FUNCTIONS, SUBROUTINES, VARIABLES, ETC.
!
! YOU ARE ALLOWED TO REDISTRIBUTE THIS CODE TO OTHERS WITH THE SAME 
! RESITRICTIONS MENTIONED ABOVE.
!
! Redistribution and use in source and binary forms, with or without
! modification, are permitted provided that the following conditions are
! met:
!
! - Redistributions of source code must retain the above copyright
!   notice, this list of conditions and the following disclaimer. 
!  
! - Redistributions in binary form must reproduce the above copyright
!   notice, this list of conditions and the following disclaimer listed
!   in this license in the documentation and/or other materials
!   provided with the distribution.
!  
! - Neither the name of the copyright holders nor the names of its
!   contributors may be used to endorse or promote products derived from
!   this software without specific prior written permission.
!  
! THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
! "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT  
! LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
! A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
! OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
! SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
! LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
! DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
! THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT  
! (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
! OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
!
!
! INTRODUCTION
!**************
! THIS MODULE CAN BE USED WITH ANY FORTRAN CODE TO PLOT THE DATA OF 
! ONE, TWO, OR THREE VARIABLES USING A PYTHON LIBRARY CALLED 
! MATPLOTLIB.
! 
! THIS CODE USE THE POWER OF A PYTHON PACKAGE CALLED MATPLOTLIB WHICH
! IS MODIFIED BY A LARGE GROUP OF PYTHON DEVELOPERS FROM DAY TO DAY WITH
! THE HIGH PERFORMANCE AND RELIABILITY OF IN COMPUTATION OF THE FORTRAN
! CODE TO HAVE GOOD REPRESENTATION FOR OUR DATA INLINE.
!
! YOU CAN USE THIS CODE TO REPRESENT YOUR DATA WHILE YOUR CODE IS STILL
! RUNNING WITH OTHER JOBS, ESPECIALLY MULTIPLE NODES/PROCESSORS MACHINES.
! SO, YOU CAN ASSIGN ONE OR MORE NODES TO PLOT YOUR DATA WHILE YOUR CODE
! IS STILL RUNNING ON THE OTHER NODES ASSIGNED FOR YOUR JOB.
!
! YOU CAN USE THIS MODULE/CODE TO DIVIDE YOUR DATA INTO GROUPS. EACH GROUP
! WILL HAVE ITS OWN DIRECTORY/FOLDER THAT HAS ALL THE DATAFILES OF THIS
! GROUP. IN ADDITION, AFTER YOU RUN THE PYTHON CODE YOU WILL HAVE ALL THE
! CREATED PLOTS OF YOUR DATA STORED AT THE SAME DIRECTORY/FOLDER. MOREOVER,
! THE PYTHON CODE WILL CREATE A ADOBE ACTOBAT PDF FILE THAT HAS ALL THE PLOTS
! CREATED FOR THAT GROUP OF DATAFILES AND AN MPEG MOVIE FILE FOR ALL THESE
! PLOTS. SO, YOU WILL HAVE ALL-IN-ON DIRECTORY/FOLDER WHICH KEEP YOUR DATA
! AND PLOTS ORGANIZED.
!
! THE MAIN SUBROUTINE IN THIS MODULE IS THE FORTPLOT SUBROUTINE WHICH IS
! CALLED WITH SOME ARGUMENTS TO GIVE YOU:
! (1) DATAFILES FOR VARIABLES NEED TO BE PLOTTED (FORMATTED OR UNFORMATTED),
! (2) PYTHON CODED FILE HAS THE CODE THAT USED TO PLOT FOR EACH GROUP OF DATA.
! (3) COLLECTIVE PYTHON CODED FILE TO RUN ALL THE PLOTS FOR ALL THE GROUPS
!     OF DATA AT SAME TIME AFTER THE EXECUSION OF THE FORTRAN CODE.
!
! WHEN YOU RUN THE PYTHON FILE YOU CAN GET ANY OR COMBINATIONS OF FOLLOWING:
! (1) PICTURES OF THE PLOTTED DATA IN A PNG FORMAT,
! (2) ADOBE ACROBAT (PDF) FILE THAT HAS ALL THE PLOTTED PICTURES FOR A CERTAIN
!     GROUP OF DATAFILES,
! (3) MOVIE FILE IN MPEG FORMAT THAT HAS ALL THE PLOTTED PICTURES FOP A CERTAIN
!     GROUP OF DATAFILES.
! 
! YOU CAN USE THIS CODE ALSO TO BUILD THE ARRAY VECTORS FOR YOUR VARIABLES
! IN TWO DIFFERENT WAYS AND THAT WILL BE INDICATED BELOW, IN ADDITION YOU CAN MESH
! ANY TWO 1D VARAIBLE ARRAYS (VECTORS) TO GET A 2D MESH GRIDED ARRAYS OF YOUR 
! VARIABLES. THIS HELPS YOU TO CREATE 3D PLOTS.
!
! EACH PLOT MUST BE DONE FOR VARIABLES OF SAME TYPES (INTEGER,LONG,REAL, OR DOUBLE).
! YOU ARE NOT ALLOWED TO USE COMBINATION OF DIFFERENT VARIBLES FOR THE SAME PLOT AT
! LEAST FOR THIS VERSION. HOWEVER, DATA TYPES CAN BE CHANGED FROM ONE PLOT TO ANOTHER
! EVEN AT THE SAME GROUP OF DATA.
!
!
! REQUIREMENTS:
!***************
! YOU HAVE TO INSTALL THE FOLLOWING TO BE ABLE TO USE THIS CODE:
! (1) FORTRAN COMPILER
! (2) PYTHON INTEPETER/COMPILER (AT LEAST PYTHON 2.7)
! (3) NUMERIC PYTHON (NUMPY) PACKAGE
! (4) SCIENTIFIC PYTHON (SCIPY) PACKAGE
! (5) MATPLOTLIB PACKAGE (AT LEAST MATPLOTLIB 1.1)
! (6) PDF FILES READER
! (7) MPEG AND PNG COMPATIBLE PROGRAMS
!
!
! LIST AND DESCRIPTION OF SUBROUTINES:
!**************************************
! FORTPLOT SUBROUTINE:
!*********************
! YOU CAN CALL THE FORPLOT SUBROUTINE IN TWO DIFFERENT WAYS ACCORDING TO THE
! WAY YOU HAVE YOUR DATA REPRESENTED IN YOUR OWN CODE.
! 
! CASE(1): SEPARATE REPRESENTATION OF DATA VARIABLES
!          IF YOU HAVE YOUR DATA VARIABLES IN THE FORM OF X,Y,Z, SO YOU CAN
!          CALL THE SUBROUTINE IN ONE THE FOLLOWING WAYS:
!          FOR ONLY ONE VECTOR DATAFILE:
!             FORTPLOT(GFC,X,AUTONAME,GA,GX)
!          FOR TWO VECTOR DATAFILES:
!             FORTPLOT(GFC,X,Y,AUTONAME,GA,GX)
!          FOR THREE VECTOR DATAFILES:
!             FORTPLOT(GFC,X,Y,Z,AUTONAME,GA,GX)
!          WHERE GX IS AN OPTIONAL CHARACTER ARRAY THAT YOU CAN BE OMITTED WHEN
!          YOU CALL THE FORPLOT SUBROUTINE. ALL THE OTHER ARGUMENTS WILL BE
!          INDICATED BELOW.
!          REMARK: X, OR X,Y, OR X,Y,Z MUST HAVE THE SAME DATA TYPES. THERE ARE FOUR
!          ALLOWED DATA TYPES FOR THIS VERSION OF FORTGRAPHER, INTEGER(4), INTEGER(8),
!          REAL(4), REAL(8). WE ARE GOING TO ALLOW MORE COMBINATIONS OF DATA TYPES IN
!          THE FUTURE VERSIONS.
!
! CASE(2): COLLECTIVE REPRESENTATION OF DATA VARIABLES
!          IF YOU HAVE YOUR DATA VARIABLES IN A COLLECTIVE FORM IN ONE MATRIX ARRAY,
!          SO YOU CAN CALL THE SUBROUTINE IN THE FOLLOWING WAY:
!             FORTPLOT(GFC,MATDIM,DATAMAT,AUTONAME,GA,GX)
!          WHERE THE REPRESENTATION OF THE DATA INSIDE THIS ARRAY OR CREATION OF THIS
!          ARRAY FROM THE X,Y,Z DATA VECTOR ARRAYS WILL BE INDICATED BELOW.
!          REMARK: X, OR X,Y, OR X,Y,Z MUST HAVE THE SAME DATA TYPES. THERE ARE FOUR
!          ALLOWED DATA TYPES FOR THIS VERSION OF FORTGRAPHER, INTEGER(4), INTEGER(8),
!          REAL(4), REAL(8). WE ARE GOING TO ALLOW MORE COMBINATIONS OF DATA TYPES IN
!          THE FUTURE VERSIONS.
!
! NOW, WE ARE GOING TO EXPLAIN THE PROPERTIES OF THE ARUMENTS OF THE FORTPLOT SUBROUTINE. 
! FORPLOT(GFC,MATDIM,DATAMAT,AUTONAME,GA,GX)
! THIS IS THE MAIN SUBROUTINE THAT WE CAN USE TO SAVE AND PLOT OUR DATA.
!
! GFC IS AN ARRAY OF 10 ITEMS THAT SPECIFY THE PROPERTIES OF THE PLOTS
! AND THE DIFFERENT FILES CREATED.
! GFC=(/G,SG,GID,NFPS,DPI,PNG,PDF,DF,DFTYPES,DTYPES/)
!
! G    IS THE PLOT OR FIGURE NUMBER WITH ALL PLOTS OF THE SAME NUMBER ARE PLOTTED
!      TOGETHER. THIS TAKES AN INTEGER VALUE 1,2,3,4,...
!      IF YOU USED THE SAME NUMBER FOR DIFFERENT DATA YOU WOULD GET UNEXPECTED PLOTS.
!      ALSO, MAY DATA OVER PLOTTED AND CAUSE THE NET FILES TO BE HUGE IN SIZE.
! SG   IS THE SUBPLOTS IN THE SAME PLOT OR FIGURE. WE CAN HAVE UP TO 9 SUBPLOTS.
!      IT TAKES A NUMBER OF THREE DIGITS IN THE FORMAT XYZ. X IS THE NUMBER OF 
!      SUBPLOT AND IT TAKES NUMBERS BETWEEN 1-9. Y REPRESENTS THE NUMBER OF ROWS
!      AND Z IS THE NUMBER OF COLUMNS WHERE Y*Z MUST GIVE THE MAXIMUM NUMBER OF
!      PLOTS ALLOWED.
!      EXAMPLE: IF YOU NEED 6 SUBPLOTS YOU CAN BUILD THEM IN TWO ROWS AND THREE
!               COLUMNS AND THEN THE MAXIMUM XYZ WILL BE 623 WITH THE SUCCESSIVE 
!               SUBPLOTS HAVE SG=123,223,323,423,523,623.
!               ALSO, YOU CAN BUILD THEM IN THREE ROWS AND TWO COLUMS AND THEN
!               THE MAXIMUM XYZ WILL BE 632 WITH THE SUCCESSIVE SUBPLOTS HAVE
!               SG=132,232,332,432,532,632.
! GID  IS THE GRAPH ID NUMBER AND YOU CAN USE IT TO HAVE DIFFERENT TYPES OF PLOTS
!          GID=1     FOR THE ONLY OR THE LAST PLOT IN CURRENT FIGURE
!          GID=2     FOR A PLOT THAT WILL BE OVER PLOTTED BY OTHER PLOT(S)
!                    YOU USE THE SAME FIGURE NUMBER (G) FOR ALL OVER PLOTS
!                    (THIS ADD HOLD IN THE PYTHON CODE SUCH LIKE THAT HOLD ON STATEMENT
!                    YOU USED IN MATLAB TO HAVE MUTILPLE PLOTS IN ONE FIGURE)
!          GID=3,4,5 FOR PLOTS WITH MULTIPLE Y-AXES. IF YOU NEED TWO DIFFERENT Y-AXES
!                    YOU USE THE SAME FIGURE NUMBER (G) AND SAME SUBPLOT NUMBER (SG)
!                    WITH GID=3 FOR ONE FIRST Y-AXIS AND GID=5 FOR THE SECOND Y-AXIS.
!                    IF YOU NEED THREE DIFFERENT Y-AXES YOU USE THE SAME FIGURE NUMBER (G)
!                    AND SAME SUBPLOT NUMBER (SG) WITH GID=3 FOR THE FIRST Y-AXIS, GID=4
!                    FOR THE SECOND Y-AXIS, THEN GID=5 FOR THE THIRD Y-AXIS.
! NFPS     IS THE NUMBER-OF-FRAME-PER-SECOND FOR THE MOVIE YOU CAN CREATE FOR THE PLOTS
!          YOU HAVE. IF YOU PUT THE NFPS=0 IT TELLS THE CODE THAT YOU DO NOT WANT ANY
!          MOVIE FOR THIS DATA PLOT.
! DPI      IS THE DOTS-PER-INCH FOR THAT GRAPH IN THIS PLOT.
! PNG      IT TAKES 0 IF YOU DO NOT WANT ANY PICTURES AND TAKES 1 IF YOU NEED PICTURES
! PDF      IT TAKES 0 IF YOU DO NOT WANT TO ADD THIS PLOT TO THE PDF FILE
!          AND TAKES 1 IF YOU NEED TO ADD THE PLOT TO THIS PDF FILE.
! DF       IT TAKES 0 IF YOU WANT TO DELETE OR REMOVE THE DATAFILES AFTER PLOTTING THEM
!          AND IT TAKES 1 IF YOU WANT TO KEEP OR SAVE THE DATAFILES AFTER PLOTTING THEM
! DFTYPES  IT TAKES 1 IF YOU NEED THE DATAFILES CREATED BY FORTRAN TO BE FORMATTED 
!          DATAFILES AND IT TAKES 2 IF YOU NEED THE DATAFILES CREATED BY THE FORTRAN
!          TO BE UNFORMATTED DATAFILES
!
! IF YOU FORGOT THE CORRESPONDING NUMBER FOR THE LAST 5 ITEMS YOU CAN USE A FUNCTION CALLED
! GETNUMOF(ITEM) AND THIS FUNCTION WILL RETURN THE NUMBER OF THE ITEM YOU CHECK.
! EXAMPLE: GETNUMOF("NO PDF")      => 0    NO PDF
!          GETNUMOF("NO PNG")      => 0    no PNG
!          GETNUMOF("PDF")         => 1    OK PDF
!          GETNUMOF("PNG")         => 1    OK PNG
!          GETNUMOF("REMOVE")      => 0    REMOVE DATAFILES
!          GETNUMOF("DELETE")      => 0    DELETE DATAFILES
!          GETNUMOF("KEEP")        => 1    KEEP DATAFILES
!          GETNUMOF("SAVE")        => 1    SAVE DATAFILES
!          GETNUMOF("FORMATTED")   => 1    FORMATTED DATAFILES
!          GETNUMOF("UNFORMATTED") => 2    UNFORMATTED DATAFILES
!          GETNUMOF("INTEGER")     => 1    INTEGER(4) DATA TYPE VARIABLES
!          GETNUMOF("LONG")        => 2    LONG OR INTEGER(8) DATA TYPE VARIABLES
!          GETNUMOF("REAL")        => 3    REAL(4) DATA TYPE VARIABLES
!          GETNUMOF("FLOAT")       => 3    FLOAT(4) DATA TYPE VARIABLES
!          GETNUMOF("DOUBLE")      => 4    DOUBLE PRECISION, REAL(8) OR FLOAT(8) DATA TYPE VARIABLES
!
!
! MATDIM IS AN ARRAY OF TWO ITEMS (DECLARED AS INTEGER :: MATDIM(2))
!        AND IT HAS THE DIMESION OF THE ARRAYS OF ANY OF THE VARIABLES YOU
!        WANT TO PLOT (X OR Y OR Z).
!        IF YOU WANT A PLOT OF THREE VARIABLES X,Y, AND Z, SO EACH HAS TO BE
!        2 DIMENSIONAL ARRAY AND YOU CAN USE:
!        MATDIM=SHAPE(X) OR MATDIM=SHAPE(Y) OR MATDIM=SHAPE(Z)
!        HOWEVER, IF YOU WANT A PLOT OF TWO VARIABLES X AND Y, SO EACH HAS TO
!        BE A 1 DIMENSIONAL ARRAY AND YOU CAN USE:
!        MATDIM=(/SIZE(X),1/) OR MATDIM=(/SIZE(Y),1/)
!        FINALLY, IF YOU WANT TO PLOT ONE VARIABLE AGAINST THE ARRAY INDEX OF
!        EACH ITEM IN THE ARRAY, SO THIS VARIABLE HAS TO BE A 1 DIMENSIONAL
!        ARRAY AND YOU CAN USE: MATDIM=(/SIZE(X),1/)
!
!
! DATAMAT HAS TO BE A 2 DIMESIONAL ARRAY OF ONE, TWO, OR THREE COLUMNS ACCORDING
!         TO THE NUMBER OF VARIABLES YOU WANT TO PLOT. YOU CAN DECLARED WITH A DEFINITE
!         SIZE OR MAKE IT ALLOCATABLE (DATATYPE, ALLOCATABLE :: DATAMAT(:,:)) AND THEN ALLOCATE
!         IT WITH THE REQUIRED SIZE.
!         IF YOU HAVE ONE VARIABLE X:
!         DATATYPE :: DATAMAT(SIZE(X),1) OR ALLOCATE(DATAMAT(SIZE(X),1))
!         IF YOU HAVE TWO VARIABLES X AND Y:
!         DATATYPE :: DATAMAT(SIZE(X),2) OR ALLOCATE(DATAMAT(SIZE(X),2))
!         DATATYPE :: DATAMAT(SIZE(Y),2) OR ALLOCATE(DATAMAT(SIZE(Y),2))
!         IF YOU HAVE THREE VARIABLES X, Y, AND Z:
!         YOU HAVE TO USE THE ITEMS IN THE MATDIM WE DESCRIBED ABOVE TO DECLARE OR ALLOCATE DATAMAT
!         DATATYPE :: DATAMAT(MATDIM(1)*MATDIM(2),3) OR ALLOCATE(DATAMAT(MATDIM(1)*MATDIM(2),2))
!         REMARK: I PREFER TO MAKE THE DATAMAT 2 DIMENSIONAL ARRAY ALLOCATABLE TO HAVE A FELXIBILITY
!                 WITH MUTIPLE VARIABLES NEED TO BE PLOTTED
!         WHEN YOU WANT TO FILL DATAMAT IN CASE OF:
!         ONE VARIABLE   : DATAMAT(:,1)=X
!         TWO VARIABLES  : DATAMAT(:,1)=X
!                          DATAMAT(:,2)=Y
!         THREE VARAIBLES: DATAMAT(:,1)=RESHAPE(X,(/MATDIM(1)*MATDIM(2)/))
!                          DATAMAT(:,2)=RESHAPE(Y,(/MATDIM(1)*MATDIM(2)/))
!                          DATAMAT(:,3)=RESHAPE(Z,(/MATDIM(1)*MATDIM(2)/))
!
! AUTONAME IS THE FULL NAME OR THE BASIC PART OF THE NAME OF THE DATAFILES.
!          THE NAME OF THE DATAFILE HAS THREE PARTS:
!          (1) THE BASIC PART WHICH DIFFERENTIATE BETWEEN DIFFERENT GROUPS OF DATAFILES
!          (2) THE NUMBER OF THIS DATAFILE IN A CERTAIN GROUP WHICH MUST BE 
!              FOUR DIGIT NUMBER
!          (3) THE EXTENSION OF THE DATAFILE WHICH MUST BE (.dat)
!          SO THE NAME OF THE FILE LOOKS LIKE: data0001.dat or gamma0101.dat
!          (WHERE CASE SENSITIVITY IS AN IMPORTANT ISSUE IN NAMING THE DATAFILES)
!          IN CASE YOU DID NOT REMOVE THE DATAFILES AND/OR THE PNG FILES THE BASIC PART
!          OF THE NAME OF THE DATAFILES WILL BE THE NAME OF THE FOLDER (DIRECTORY) 
!          THAT CONTAINS ALL THE DATAFILES, PNG FILES, PDF FILE AND MPG FILE.
!          IF YOU CHOOSE TO REMOVE BOTH THE DATAFILES AND THE PNG FILES, THEN THE PDF
!          AND/OR THE MPG FILE WILL BE SAVED IN THE CURRENT FOLDER (DIRECTORY).
!          THERE ARE MANY CASES HERE:
!          (1) PASSING THE FULL NAME OF EACH FILE ATTACHED TO THE DATA YOU NEED TO PLOT
!              AND THIS CAN HAPPEN IN TWO WAYS:
!              (I) YOU CAN ADD THE NAME OF THE FILE YOURSELF AND CARE ABOUT THE COUNTING OF
!                  THE NUMBER OF THE DATAFILES.
!              (II)YOU CAN USE THE FUNCTION GETFNAME("BASIC PART",NUM) TO GIVE YOU THE RIGHT
!                  FORMAT OF THE NAME OF THE FILE THAT YOU CAN PASS IT DIRECTLY TO THE 
!                  FORPLOT SUBROUTINE. YOU CAN DO THAT BY HAVING AN INTEGER COUNTER FOR
!                  THE NUMBER OF DATAFILES YOU NEED AND PASS THAT IN THE NUM ARGUMENT OF THE
!                  GETFNAME FUNCTION.
!          (2) PASSING THE BASIC PART TO THE AUTONAME ARGUMENT OF THE FORPLOT SUBROUTINE
!              AND IT WILL CARE ABOUT THE DATAFILE FORMAT AND NUMBERING OF THESE FILES.
!          THE MAXIMUM NUMBER OF DATAFILES THAT YOU USE WITH THIS CODE IS 10,000 FILES FOR
!          GROUP OF DATAFILES IF YOU NAMED THE FILES YOURSELF OR BY USING GETFNAME FUNCTION
!          OR 10,000 FILES FOR ALL GROUPS COMBINED FOR THE GROUPS OF DATAFILES THAT YOU ONLY
!          PASSED THEIR BASIC PART TO THE AUTONAME ARGUMENT IN THE FORPLOT SUBROUTINE.
!
!
! GA IS AND ARRAY OF CHARACTER THAT HAS ALL THE ADJUSTMENT PROPERTIES OF THE PLOT YOU NEED TO PLOT 
!    SUCH AS THE AXES LABELS, THE AXES LIMITS, THE TICK LOCATION, THE TICK FORMAT, ETC.
!    YOU CAN DECLARE THE SIZE OF THIS ARRAY AND THE CHARACTER LENGTH OF EACH OF ITS ITEM ACCORDING 
!    TO YOUR NEED. THIS ARRAY IS USED FOR WHO IS NOT FAMILIAR WITH THE MATPLOTLIB PYTHON PLOTTING
!    COMMANDS OR WHO DOES NO NEED TO WRITE DOWN THE WHOLE COMMANDS. IF YOU NEED EXTRA COMMANDS YOU
!    HAVE TWO WAYS: (1) ADD THEM TO THE CODE TO BE PERMINANT, (2) ADD THE COMMAND TO GX ARRAY THAT
!    WE ARE GOING TO TALK ABOUT IT LATER.
!    IN ADDTION, YOU CAN ADD YOUR OWN CODE FROM THE BEGINING BY USING GA(1)="SELF" AND
!    GA(2)="fig=figure(figure number,....)" and GA(3)="ax=fig.add_subplot(subplot number,....)" 
!    THEN CONTINUE ADDING YOUR COMMANDS FOR THE REST OF BOTH THE GA AND GX ARRAYS.
!
!    LIST OF PREDEFINED GA ARRAY ITEMS:
!    GA(1) :: FOR THE PLOT TYPE YOU NEED
!             FOR 3D PLOTS YOU CAN USE: "plot3d","wireframe","surface","contour","contourf","contour3d"
!             FOR 2D PLOTS YOU CAN USE: "plot","scatter","semilog","loglog","vhist","hhist","bar"
!    GA(2) :: "text" FOR THE PLOT TITLE
!    GA(3) :: "integer" FOR THE PLOT TITLE FONTSIZE
!    GA(4) :: "text" FOR THE X AXIS LABEL
!    GA(5) :: "integer" FOR THE X AXIS LABEL FONTSIZE
!    GA(6) :: "text" FOR THE Y AXIS LABEL
!    GA(7) :: "integer" FOR THE Y AXIS LABEL FONTSIZE
!    GA(8) :: "text" FOR THE Z AXIS LABEL
!    GA(9) :: "integer" FOR THE Z AXIS LABEL FONTSIZE
!    GA(10) :: MIN AND MAX LIMITS FOR X AXIS "(number,number)"
!    GA(11) :: MIN AND MAX LIMITS FOR Y AXIS "(number,number)"
!    GA(12) :: MIN AND MAX LIMITS FOR Z AXIS "(number,number)"
!    GA(13) :: SCALE OF X AXIS AS: "linear","log",etc.
!    GA(14) :: SCALE OF Y AXIS AS: "linear","log",etc.
!    GA(15) :: SCALE OF Z AXIS AS: "linear","log",etc.
!    GA(16) :: TURN ON/OFF THE GRID (DEFAULT OFF) AND YOU CAN USE:
!              "yes"=> GRID ON
!              "no" => GRID OFF
!    GA(17) :: "text" FOR THE SUPER TITLE OF THE PLOTS AND IT HELPS ALOT WITH THE MULTIPLE PLOTS IN ONE FIGURE.
!              SO, YOU CAN HAVE A TITLE FOR EACH SUBPLOT AND A SUPER TITLE FOR THE WHOLE FIGURE.
!    GA(18) :: "integer" FOR THE SUPER TITLE FONTSIZE
!    GA(19) :: EMPTY
!    GA(20) :: "text" AS A LABEL FOR EACH LINE IN A PLOT.
!              IT HELPS WITH MAKING A LEGEND FOR MULTIPLE PLOTS IN ONE FIGURE.
!    GA(21) :: TAKES ONE OR TWO LETTER FOR LINE PLOT OR CONTOUR LINE COLOR AND THEIR SHAPE
!              "r" => RED		"g" => GREEN	"m" => MAGENTA
!              "b" => BLUE	"k" => BLACK	"w" => WHITE
!              "c" => CYAN	"y" => YELLOW
!              SHAPES ARE:
!              "*" => STARS 	"O" => SOLID CIRCLES	"--" => DASHED
!              "^" => TRIANGLES				"s" => SQUARES
!    GA(22) :: "integer" LINE OR CONTOUR LINE SIZE (WIDTH)
!    GA(23) :: "no" => LEGEND OFF (DEFAULT)
!              "yes"=> LEGEND ON
!    GA(24) :: LEGEND POSITION: "upper left","lower right","upper center","best"
!    GA(25) :: "integer" LENGEND FONTSIZE
!    GA(26) :: "integer" LENGEND NUMBER OF COLUMNS
!    GA(27) :: "one letter" 2D FIGURE BACKGROND COLOR
!    GA(28) :: "one letter" 2D FIGURE EDGE COLOR
!    GA(29) :: "(integer,integer)" 2D FIGURE SIZE
!    GA(30) :: "integer" 3D NUMBER OF STEPS BETWEEN ROW CONTOUR LINES
!    GA(31) :: "integer" 3D NUMBER OF STEPS BETWEEN COLUMNS CONTOUR LINES
!    GA(32) :: "fraction number" BETWEEN 0.0 TO 1.0 FOR THE LEVEL OF TRANSPARENCY OF THE FIGURE
!    GA(33) :: "no" => COLOR BAR OFF (DEFAULT)
!              "yes"=> COLOR BAR ON
!    GA(34) :: "vertical"  => COLOR BAR ORIENTATION VERTICAL (DEFAULT)
!              "HORIZONTAL"=> COLOR BAR ORIENTATION HORIZONTAL
!    GA(35) :: "fraction number" COLOR BAR SHRINK RATIO
!    GA(36) :: "integer" COLOR BAR TICKS FONTSIZE
!    GA(37) :: "text" COLOR BAR TITLE
!    GA(38) :: "integer" COLOR BAR TITLE FONTSIZE
!    GA(39) :: "integer" X AXIS TICKS FONTSIZE
!    GA(40) :: "integer" Y AXIS TICKS FONTSIZE
!    GA(41) :: X AXIS TICKS FORMAT (SIMILAR TO FORTRAN BUT ENDS WITH THE FORMAT TYPE):
!              "2.4d","1.2f","5.3e",...
!    GA(42) :: Y AXIS TICKS FORMAT (SIMILAR TO FORTRAN BUT ENDS WITH THE FORMAT TYPE):
!              "2.4d","1.2f","5.3e",...
!    GA(43) :: "integer" X AXIS TICKS LOCATOR (MULTIPLES OF SOME NUMBERS)
!    GA(44) :: "integer" Y AXIS TICKS LOCATOR (MULTIPLES OF SOME NUMBERS)
!    GA(45) :: ROTATION OF X AXIS TICKS
!              "vertical","horizontal","angle in degree"
!    GA(46) :: ROTATION OF Y AXIS TICKS
!              "vertical","horizontal","angle in degree"
!    GA(47) :: "no" => CONTOUR LABELS OFF (DEFAULT)
!              "yes"=> CONTOUR LABELS ON
!    GA(48) :: "integer" CONTOUR LABELS FONTSIZE
!    GA(49) :: "fraction number" CONTOUR INLINE
!    GA(50) :: CONTOUR PROJECTION OF A 3D PLOT ON THE SIDE 2D PLANES
!              "no" => NO CONTOUR PROJECTION
!              "xy" => CONTOUR PROJECTION ON THE XY PLANE
!              "xz" => CONTOUR PROJECTION ON THE XZ PLANE
!              "yz" => CONTOUR PROJECTION ON THE YZ PLANE
!    GA(51) :: "text" TEXT TO BE ADDED TO THE FIGURE PLOT
!    GA(52) :: "(number,number)" POSITION FOR THE TEXT TO BE ADDED
!    GA(53) :: "integer" TEXT FONTSIZE
!    GA(54) :: "one letter" TEXT COLOR
!    GA(55) :: EMPTY
!    GA(56) :: "text" ANNOTATTE TEXT (TEXT PLUS AN ARROW POITING TO A CERTAIN POINT)
!    GA(57) :: "(number,number)" POSITION OF THE ANNOTATE TEXT
!    GA(58) :: "(number,number)" POSITION OF THE ANNOTATE ARROW
!    GA(59) :: "integer" ANNOTATE FONTSIZE
!    GA(60) :: "one letter" ANNOTATE COLOR
!    GA(61) :: "yes" USE A LOGARITHMIC SCALE ON THE CONTOUR COULOR BAR
!    GA(62) :: COLOR SCHEME TO BE USED WITH THE CBAR. e.g.: "jet","hot","gray", etc. 
!    GA(63) :: COLOR BAR LOWER LIMIT
!    GA(64) :: COLOR BAR UPPER LIMIT
!
!    INSTEAD OF USING NUMBER INDICES WITH GA, YOU CAN UES THE LIST OF VARAIBLE NAMES
!    THAT DEFINED BELOW WHICH MAKE THE INDICES MORE RECOGNIZABLE FOR THE USER.
!    ALL THE VARIABLES IN THIS LIST CAN NOT BE USED BUY THE USED IN THE PROGRAM,
!    SUBROUTINE, FUNCTION, OR THE MODULE THAT YOU USE FORGRAPHER MODULE WITH IT,
!    OR YOUR RESULTS MIGHT BE AFFECTED.
!
!    THE LIST OF PREDIFNED NAMED FOR GA INDEX ARE:
!    
!    IPLOT=1,	  	TITLE=2,		TITLEfs=3,		GRID=16
!    FIGBCOLOR=27,	FIGEDGECOLOR=28,	FIGSIZE=29
!    IPLOTLABEL=20,	LINEPROP=21,		LINESIZE=22
!    SUPERTITLE=17,	SUPERTITLEfs=18
!    XLABEL=4,		XLABELfs=5,		XLIMITS=10,		XSCALE=13
!    YLABEL=6,	  	YLABELfs=7,		YLIMITS=11,		YSCALE=14
!    ZLABEL=8,	  	ZLABELfs=9,		ZLIMITS=12,		ZSCALE=15
!    LEGEND=23,	  	LEGENDPOS=24,		LEGENDfs=25,		LEGENDNCOL=26
!    RSTRIDE=30,	CSTRIDE=31,		ALPHA=32
!    CBAR=33,	  	CBARDIR=34,		CBARSIZE=35,		CBARfs=36
!    CBARTITLE=37,	CBARTITLEfs=38
!    XTICKSfs=39, 	XTICKSFMT=41,		XTICKSLOC=43,		XTICKSROT=45
!    YTICKSfs=40, 	YTICKSFMT=42,		YTICKSLOC=44,		YTICKSROT=46
!    CTRLABEL=47, 	CTRLABELfs=48,		CTRINLINE=49
!    CTRPRJECTION=50
!    PLOTTXT=51,  	PLOTTXTPOS=52,		PLOTTXTfs=53,		PLOTTXTCOLOR=54
!    ANNOTATETXT=56,	ANNOTATETXTPOS=57,	ANNOTATEARWPOS=58,	ANNOTATEfs=59
!    ANNOTATECOLOR=60
!    CBARLOG=61         CBARCSCHEME=62          CBARLWLIMIT=63          CBARUPLIMIT=64
!
!    YOU CAN DECLARE THE GA ARRAY UP TO THE ITEM YOU WILL USE.
!    EXAMPLES:
!     IF YOU NEED ONLY THE FIRST TEN ITEMS EACH OF 25 CHARACTER, YOU CAN DECLARED LIKE:
!     CHARACTER*25 :: GA(10)
!     IF YOU NEED ONLY THE FIRST 25 ITEMS EACH OF 10 CHARACTER, YOU CAN DECLARED LIKE:
!     CHARACTER*10 :: GA(25)
!     IF YOU NEED ONLY THE ITEM NUMBER 45, YOU HAVE TO DECLARED LIKE:
!     CHARACTER*25 :: GA(45)
!    SO YOU CAN NOT DECLARED GA LESS THAT THE TARGET ITEM.
!
!
!
! GX IS AN EXTRA PLOT ADJUSTMENT ARRAY THAT YOU CAN DELCARED WITH SIZE ACCORDING TO YOUR NEED.
!    YOU HAVE TO ADD THE COMPLETE COMMAND OF THE MATPLOTLIB PYTHON CODE TO THE ITEMS OF THIS ARRAY.
!    THIS ARRAY CAN HELP YOU TO EXTEND YOUR WORK BEYOND WHAT IS AVAILABEL IN THE GA ARRAY.
!
!
! FUNCTION GETFNAME
!*******************
! FUNCTION GETFNAME(PART1,NUM)
! GIVES THE FULL NAME OF A DATAFILE WITH EXTENSION ".dat"
! PART1 :: IS THE BASIC PART OF THE NAME AND IT IS GIVEN FOR THE FOLDER/DIRECTOR NAME
! NUM   :: IS THE NUMBER OF THE DATAFILE IN A CERTAIN CATEGORY OF DATAFILES
!
!
! FUNCTION GETVALOF
!*******************
! FUNCTION GETVALOF(FP)
! GIVES THE CORRESPONDING INTEGER NUMBER FOR ANY ITEM IN THE GFC ARRAY PASSED TO
! THE FORTPLOT SUBROUTINE
! FP ALTERNATIVES ARE DESCRIBED ABOVE.
! 
!
! SUBROUTINE DOTPY
!*****************
! SUBROUTINE DOTPY(autoName,N,MATDIM,GFC,GA,GX)
! GENERATES THE "*.py" FILE THAT HAS THE PLOTTING INSTRUCTION FOR A CERTAIN GROUP OF DATAFILES.
! ALL THE ITEMS ARE DESCRIBED BEFORE
!
!
! SUBROUTINE BUILDMAINPY
!************************
! SUBROUTINE BUILDMAINPY(FNAME)
! CREATE A "mainPY.py" FILE THAT HAS EXECUTION COMMAND FOR ALL "*.py" FILES
! CREATED AND CAN BE USED TO RUN ALL THESE FILES SQUENTIALLY AFTER THE CREATION OF ALL OF THEM
! INSTEAD OF RUN THEM ONE-BY-ONE.
! ACTUALLY, WE SOMETIMES NEED TO RUN THEM ONE-BY-ONE TO SEE THE PLOTTED DATA RIGHT AFTER IT IS
! AVAILABLE INSTEAD OF WAITING UP TO THE END OF THE EXECUTION OF THE FORTRAN CODE WHICH MAY TAKE
! VERY LONG TIME.
!
!
! SUBROUTINE LINVECTOR
!************************
! SUBROUTINE R4LINVECTOR(A,B,N,MAT1D)
! CAN BE USED TO CREATE A 1D VARIABLE ARRAY OF ANY DATA TYPE
! A     :: THE FIRST NUMBER (VALUE) IN THE ARRAY
! B     :: THE LAST NUMBER (VALUE) IN THE ARRAY
! N     :: THE NUMBER OF STEPS FROM A TO B
! MAT1D :: THE VECTOR ARRAY OF THE VARIABLE
! THE LENGTH OF MAT1D IS N+1
!
!
! SUBROUTINE VARVECTOR
!**********************
! SUBROUTINE VARVECTOR(A,B,STEP,MAT1D)
! CAN BE USED TO CREATE A 1D VARIABLE ARRAY OF ANY DATA TYPE
! A     :: THE FIRST NUMBER (VALUE) IN THE ARRAY
! B     :: THE LAST NUMBER (VALUE) IN THE ARRAY
! STEP  :: THE INCREMENTAL STEP FROM A TO B
! MAT1D :: THE VECTOR ARRAY OF THE VARIABLE
! 
!
! SUBROUTINE MESHGRID
!********************* 
! SUBROUTINE MESHGRID(XMAT1D,YMAT1D,XMAT2D,YMAT2D)
! OR,
! SUBROUTINE MESHGRID(XMAT1D,YMAT1D,ZMAT1D,XMAT3D,YMAT3D,ZMAT3D)
! CAN BE USED TO CREATE A MESHGRID BETWEEN TWO OR THREE 1D VECTOR ARRAYS
! TO HAVE TWO 2D MATRICES OR THREE 3D MATRICES.
! XMAT1D :: 1D VECTOR ARRAY FOR X VARIABLE
! YMAT1D :: 1D VECTOR ARRAY FOR Y VARIABLE
! XMAT2D :: 2D VECTOR ARRAY FOR X VARIBALE MESHED WITH Y VARIABLE
! YMAT2D :: 2D VECTOR ARRAY FOR Y VARIBALE MESHED WITH X VARIABLE
! 
!
!
! SUBROUTINE UFDATAFILE
!***********************
! SUBROUTINE UFDATAFILE(autoName,N,filestatus,x,y,z)
! CAN BE USED TO CREATE UNFORMATTED DATAFILES FOR ONE, TWO, OR THREE VARIABLES
! autoname   :: IS THE NAME OF THE FILE
! filestatus :: TAKES 0 FOR THE FIRST FILE IN THE CATEGORY AND 1 AFTER THAT.
!               ALL FILES IN THE SAME CATEGORY HAVE THE SAME BASIC PART OF THE NAME.
! x,y,z      :: VARIABLES TO BE PLOTTED.
!               y AND z VARIABLES ARE OPTIONAL VARIABLES SO YOU CAN ADD ONE, TWO,
!               THREE VARIABLES TO BE WRITTEN IN THE FILE.
!
!
! SUBROUTINE UFDATAFILE
!***********************
! SUBROUTINE UFDATAFILE(autoName,N,filestatus,x,y,z)
! CAN BE USED TO CREATE FORMATTED DATAFILES FOR ONE, TWO, OR THREE VARIABLES
! autoname   :: IS THE NAME OF THE FILE
! filestatus :: TAKES 0 FOR THE FIRST FILE IN THE CATEGORY AND 1 AFTER THAT.
!               ALL FILES IN THE SAME CATEGORY HAVE THE SAME BASIC PART OF THE NAME.
! x,y,z      :: VARIABLES TO BE PLOTTED.
!               y AND z VARIABLES ARE OPTIONAL VARIABLES SO YOU CAN ADD ONE, TWO,
!               THREE VARIABLES TO BE WRITTEN IN THE FILE.
!
!
!**********************************************************************

! INTEFACES FOR MULTIPLE DATA TYPES SUBROUTINES AND FUNCTIONS

 INTERFACE FORTPLOT
  MODULE PROCEDURE I4DGRAPHER1VAR,I8DGRAPHER1VAR,r4DGRAPHER1VAR,r8DGRAPHER1VAR, &
                 & I4DGRAPHER2VAR,I8DGRAPHER2VAR,r4DGRAPHER2VAR,r8DGRAPHER2VAR, & 
                 & I4DGRAPHER3VAR,I8DGRAPHER3VAR,r4DGRAPHER3VAR,r8DGRAPHER3VAR
 END INTERFACE FORTPLOT

 INTERFACE FDATAFILE
  MODULE PROCEDURE I4FDATAFILE,I8FDATAFILE,R8FDATAFILE,R4FDATAFILE
 END INTERFACE FDATAFILE

 INTERFACE UFDATAFILE
  MODULE PROCEDURE I4UFDATAFILE,I8UFDATAFILE,R8UFDATAFILE,R4UFDATAFILE
 END INTERFACE UFDATAFILE

 INTERFACE MESHGRID
  MODULE PROCEDURE I4MESHGRID2D,I8MESHGRID2D,I4MESHGRID3D,I8MESHGRID3D, &
                 & R8MESHGRID2D,R4MESHGRID3D,R8MESHGRID3D,R4MESHGRID2D
 END INTERFACE MESHGRID

 INTERFACE VARVECTOR
  MODULE PROCEDURE I4VARVECTOR,I8VARVECTOR,R8VARVECTOR,R4VARVECTOR
 END INTERFACE VARVECTOR

 INTERFACE LINVECTOR
  MODULE PROCEDURE I4LINVECTOR,I8LINVECTOR,R8LINVECTOR,R4LINVECTOR
 END INTERFACE LINVECTOR

 INTERFACE NUM2STR
  MODULE PROCEDURE I4NUM2STR
 END INTERFACE NUM2STR

! LIST OF ALL VARAIBLES THAT CAN BE USED AS INDEX IN THE GA ARRAY THAT HAS
! ALL THE PROPERTIES OF THE FIGURE YOU NEED TO PLOT.

 INTEGER(4), PARAMETER :: IPLOT=1,TITLE=2,TITLEfs=3,GRID=16
 INTEGER(4), PARAMETER :: FIGBCOLOR=27,FIGEDGECOLOR=28,FIGSIZE=29
 INTEGER(4), PARAMETER :: IPLOTLABEL=20,LINEPROP=21,LINESIZE=22
 INTEGER(4), PARAMETER :: SUPERTITLE=17,SUPERTITLEfs=18
 INTEGER(4), PARAMETER :: XLABEL=4,XLABELfs=5,XLIMITS=10,XSCALE=13
 INTEGER(4), PARAMETER :: YLABEL=6,YLABELfs=7,YLIMITS=11,YSCALE=14
 INTEGER(4), PARAMETER :: ZLABEL=8,ZLABELfs=9,ZLIMITS=12,ZSCALE=15
 INTEGER(4), PARAMETER :: LEGEND=23,LEGENDPOS=24,LEGENDfs=25
 INTEGER(4), PARAMETER :: LEGENDNCOL=26
 INTEGER(4), PARAMETER :: RSTRIDE=30,CSTRIDE=31,ALPHA=32
 INTEGER(4), PARAMETER :: CBAR=33,CBARDIR=34,CBARSIZE=35,CBARfs=36
 INTEGER(4), PARAMETER :: CBARTITLE=37,CBARTITLEfs=38
 INTEGER(4), PARAMETER :: XTICKSfs=39,XTICKSFMT=41,XTICKSLOC=43
 INTEGER(4), PARAMETER :: XTICKSROT=45
 INTEGER(4), PARAMETER :: YTICKSfs=40,YTICKSFMT=42,YTICKSLOC=44
 INTEGER(4), PARAMETER :: YTICKSROT=46
 INTEGER(4), PARAMETER :: CTRLABEL=47,CTRLABELfs=48,CTRINLINE=49
 INTEGER(4), PARAMETER :: CTRPRJECTION=50
 INTEGER(4), PARAMETER :: PLOTTXT=51,PLOTTXTPOS=52,PLOTTXTfs=53
 INTEGER(4), PARAMETER :: PLOTTXTCOLOR=54
 INTEGER(4), PARAMETER :: ANNOTATETXT=56,ANNOTATETXTPOS=57
 INTEGER(4), PARAMETER :: ANNOTATEARWPOS=58,ANNOTATEfs=59
 INTEGER(4), PARAMETER :: ANNOTATECOLOR=60
 INTEGER(4), PARAMETER :: CBARLOG=61,CBARCSCHEME=62
 INTEGER(4), PARAMETER :: CBARLWLIMIT=63,CBARUPLIMIT=64
 INTEGER(4), PARAMETER :: CCBARTICKS=65,CCBARLEVELS=66,CCBARNORM=67
 INTEGER(4), PARAMETER :: CBARTICKS=68,CBARLEVELS=69,CBARNORM=70

 INTEGER(4) :: PLTFIGNUM=1,PLTSFIGNUM=2,PLTFIGHOLD=3,MOVNFPS=4,PLTDPI=5
 INTEGER(4) :: PNGSAVE=6,PDFSAVE=7,DATSAVE=8,DATTYPE=9,PLTYYAXES=10

 CONTAINS

 SUBROUTINE I4DGRAPHER1VAR(GFC,X,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(4)             :: X(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,1/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,1/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I4DGRAPHER1VAR

 SUBROUTINE I8DGRAPHER1VAR(GFC,X,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(8)             :: X(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,2/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,2/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I8DGRAPHER1VAR

 SUBROUTINE r4DGRAPHER1VAR(GFC,X,FN,GA,GX)
  IMPLICIT NONE
  REAL(4)                :: X(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(SIZE(GFC).LT.11) THEN
   WRITE(*,*) "ERROR@FORTGRAPHER: GFC ARRAY MUST BE OF SIZE 10 OR LARGER"
   STOP
  ELSE
   IF(GFC(1).LT.0) THEN
    WRITE(*,*) "ERROR@FORTGRAPHER: GFC(1) MUST BE LARGE THAN OR EQUAL ZERO"
    STOP
   END IF
   IF(GFC(2).LT.0.OR.GFC(2).GT.999) THEN
    WRITE(*,*) "ERROR@FORTGRAPHER: GFC(2) MUST BE BETWEEN 111 AND 999"
    STOP
   END IF
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,3/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,3/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r4DGRAPHER1VAR

 SUBROUTINE r8DGRAPHER1VAR(GFC,X,FN,GA,GX)
  IMPLICIT NONE
  REAL(8)                :: X(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN

    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,4/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),1,(/SIZE(X),1/),(/GFC,4/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r8DGRAPHER1VAR


 SUBROUTINE I4DGRAPHER2VAR(GFC,X,Y,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(4)             :: X(:),Y(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,1/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,1/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I4DGRAPHER2VAR

 SUBROUTINE I8DGRAPHER2VAR(GFC,X,Y,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(8)             :: X(:),Y(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,2/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,2/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I8DGRAPHER2VAR

 SUBROUTINE r4DGRAPHER2VAR(GFC,X,Y,FN,GA,GX)
  IMPLICIT NONE
  REAL(4)                :: X(:),Y(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,3/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,3/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r4DGRAPHER2VAR

 SUBROUTINE r8DGRAPHER2VAR(GFC,X,Y,FN,GA,GX)
  IMPLICIT NONE
  REAL(8)                :: X(:),Y(:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG
  INTEGER(4)             :: SYSFLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN),SYSFLAG)
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),SIZE(X),filestatus,x,y)
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,4/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),2,(/SIZE(X),1/),(/GFC,4/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r8DGRAPHER2VAR


 SUBROUTINE I4DGRAPHER3VAR(GFC,X,Y,Z,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(4)             :: X(:,:),Y(:,:),Z(:,:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: DATALEN,MATDIMS(2)
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))

   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  MATDIMS=SHAPE(X)
  DATALEN=MATDIMS(1)*MATDIMS(2)

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,1/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,1/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I4DGRAPHER3VAR

 SUBROUTINE I8DGRAPHER3VAR(GFC,X,Y,Z,FN,GA,GX)
  IMPLICIT NONE
  INTEGER(8)             :: X(:,:),Y(:,:),Z(:,:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: DATALEN,MATDIMS(2)
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  MATDIMS=SHAPE(X)
  DATALEN=MATDIMS(1)*MATDIMS(2)

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,2/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,2/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE I8DGRAPHER3VAR

 SUBROUTINE r4DGRAPHER3VAR(GFC,X,Y,Z,FN,GA,GX)
  IMPLICIT NONE
  REAL(4)                :: X(:,:),Y(:,:),Z(:,:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: DATALEN,MATDIMS(2)
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  MATDIMS=SHAPE(X)
  DATALEN=MATDIMS(1)*MATDIMS(2)

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,3/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,3/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r4DGRAPHER3VAR

 SUBROUTINE r8DGRAPHER3VAR(GFC,X,Y,Z,FN,GA,GX)
  IMPLICIT NONE
  REAL(8)                :: X(:,:),Y(:,:),Z(:,:)
  INTEGER(4)             :: GFC(:)
  CHARACTER(*)           :: FN
  CHARACTER(*)           :: GA(:)
  CHARACTER(*),OPTIONAL  :: GX(:)

  INTEGER(4), SAVE       :: FID = 1
  INTEGER(4)             :: DATALEN,MATDIMS(2)
  INTEGER(4)             :: N,FILESTATUS

  character(len=25)      :: AUTONAME
  character(len=50)      :: FNAME
  LOGICAL                :: FLAG


  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   FNAME=TRIM(GA(2))
   IF(TRIM(FNAME(1:10)).NE."fig=figure") THEN
    WRITE(*,*) "Missing: GA(2)='fig=figure(FigNum,...)'"
    RETURN
   ENDIF
   FNAME=TRIM(GA(3))
   IF(TRIM(FNAME(1:18)).NE."ax=fig.add_subplot") THEN
    WRITE(*,*) "Missing: GA(3)='ax=fig.add_subplot(SubFigNum,...)'"
    RETURN
   ENDIF
   FNAME=""
  END IF

  IF(LEN_TRIM(FN).EQ.0) THEN
   AUTONAME=GETFNAME("Data",FID)
   FID=FID+1
   INQUIRE(FILE="Data",EXIST=FLAG)
   IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir Data")
  ELSE
   N=LEN(TRIM(FN))
   IF(FN(N-3:N).NE.".dat") THEN
    INQUIRE(FILE=TRIM(FN),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN))
    AUTONAME=GETFNAME(TRIM(FN),FID)
    FID=FID+1
   ELSE
    INQUIRE(FILE=TRIM(FN(1:N-12)),EXIST=FLAG)
    IF(FLAG.EQV..FALSE.) CALL SYSTEM("mkdir "//TRIM(FN(1:N-12)))

    AUTONAME=FN
   END IF
  END IF

  MATDIMS=SHAPE(X)
  DATALEN=MATDIMS(1)*MATDIMS(2)

  IF(GFC(1).NE.0) CALL BUILDMAINPY(TRIM(AUTONAME))
  IF(GFC(9).EQ.2) THEN
   CALL UFDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ELSE IF(GFC(9).EQ.1) THEN
   CALL  FDATAFILE(TRIM(AUTONAME),DATALEN,filestatus,RESHAPE(TRANSPOSE(X),(/DATALEN/)),RESHAPE(TRANSPOSE(Y),(/DATALEN/)),RESHAPE(TRANSPOSE(Z),(/DATALEN/)))
  ENDIF
  IF(FILESTATUS.EQ.1.AND.GFC(1).NE.0) THEN
   IF(PRESENT(GX)) THEN
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,4/),GA,GX)
   ELSE
    CALL DOTPY(TRIM(AUTONAME),3,MATDIMS,(/GFC,4/),GA)
   ENDIF
  END IF

  N=LEN_TRIM(AUTONAME)
  CALL SYSTEM(TRIM("mv "//TRIM(AUTONAME)//" "//TRIM(AUTONAME(1:N-8))))

  RETURN
 END SUBROUTINE r8DGRAPHER3VAR



! SUBROUTINES FOR CREATING AND SAVING THE VARIABLES DATA TO FORMATTED DATAFILES

 SUBROUTINE I4FDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  INTEGER(4),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  INTEGER(4),DIMENSION(N),OPTIONAL :: y,z
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID      
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:
  OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='OLD',ACTION='WRITE',ACCESS="APPEND",IOSTAT=ferror)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
   FILESTATUS=1
  END IF
  IF(PRESENT(y).AND.PRESENT(z)) THEN
   DO i=1,N
    WRITE(102,"(I9,T23,I9,T46,I9)") x(i),y(i),z(i)
   END DO
  ELSE IF(PRESENT(y)) THEN
   DO i=1,N
    WRITE(102,"(I9,T23,I9)") x(i),y(i)
   END DO
  ELSE
   DO i=1,N
    WRITE(102,"(I9)") x(i)
   END DO
  END IF
  CLOSE(102)

  RETURN
 END SUBROUTINE I4FDATAFILE

 SUBROUTINE I8FDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  INTEGER(8),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  INTEGER(8),DIMENSION(N),OPTIONAL :: y,z
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID      
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:
  OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='OLD',ACTION='WRITE',ACCESS="APPEND",IOSTAT=ferror)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
   FILESTATUS=1
  END IF
  IF(PRESENT(y).AND.PRESENT(z)) THEN
   DO i=1,N
    WRITE(102,"(I19,T25,I19,T50,I19)") x(i),y(i),z(i)
   END DO
  ELSE IF(PRESENT(y)) THEN
   DO i=1,N
    WRITE(102,"(I19,T25,I19)") x(i),y(i)
   END DO
  ELSE
   DO i=1,N
    WRITE(102,"(I19)") x(i)
   END DO
  END IF
  CLOSE(102)

  RETURN
 END SUBROUTINE I8FDATAFILE

 SUBROUTINE r4FDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  REAL(4),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  REAL(4),DIMENSION(N),OPTIONAL :: y,z
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID      
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:
  OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='OLD',ACTION='WRITE',ACCESS="APPEND",IOSTAT=ferror)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
   FILESTATUS=1
  END IF
  IF(PRESENT(y).AND.PRESENT(z)) THEN
   DO i=1,N
    WRITE(102,"(1ES15.8,T23,1ES15.8,T46,1ES15.8)") x(i),y(i),z(i)
   END DO
  ELSE IF(PRESENT(y)) THEN
   DO i=1,N
    WRITE(102,"(1ES15.8,T23,1ES15.8)") x(i),y(i)
   END DO
  ELSE
   DO i=1,N
    WRITE(102,"(1ES15.8)") x(i)
   END DO
  END IF
  CLOSE(102)

  RETURN
 END SUBROUTINE r4FDATAFILE

 SUBROUTINE r8FDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  REAL(8),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  REAL(8),DIMENSION(N),OPTIONAL :: y,z
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID      
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:
  OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='OLD',ACTION='WRITE',ACCESS="APPEND",IOSTAT=ferror)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(autoName),STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
   FILESTATUS=1
  END IF
  IF(PRESENT(y).AND.PRESENT(z)) THEN
   DO i=1,N
    WRITE(102,"(1ES15.8,T23,1ES15.8,T46,1ES15.8)") x(i),y(i),z(i)
   END DO
  ELSE IF(PRESENT(y)) THEN
   DO i=1,N
    WRITE(102,"(1ES15.8,T23,1ES15.8)") x(i),y(i)
   END DO
  ELSE
   DO i=1,N
    WRITE(102,"(1ES15.8)") x(i)
   END DO
  END IF
  CLOSE(102)

  RETURN
 END SUBROUTINE r8FDATAFILE


! SUBROUTINES FOR CREATING AND SAVING THE VARIABLES DATA TO UNFORMATTED DATAFILES

 SUBROUTINE I4UFDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE
 
  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  INTEGER(4),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  INTEGER(4),DIMENSION(N),OPTIONAL :: y,z
  INTEGER(4),ALLOCATABLE,DIMENSION(:,:) :: DATAMAT
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID,rec_array
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:

  IF(PRESENT(y).AND.PRESENT(z)) THEN
   ALLOCATE(DATAMAT(N,3))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
   DATAMAT(:,3)=Z
  ELSE IF(PRESENT(y)) THEN
   ALLOCATE(DATAMAT(N,2))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
  ELSE
   ALLOCATE(DATAMAT(N,1))
   DATAMAT(:,1)=X
  END IF

  INQUIRE(IOLENGTH=rec_array) DATAMAT
  OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='NEW',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='REPLACE',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  ELSE
   FILESTATUS=1
  END IF

  WRITE(102,rec=1) (0*DATAMAT)
  WRITE(102,rec=2) DATAMAT

  CLOSE(102)

  RETURN
 END SUBROUTINE I4UFDATAFILE

 SUBROUTINE I8UFDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  INTEGER(8),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  INTEGER(8),DIMENSION(N),OPTIONAL :: y,z
  INTEGER(8),ALLOCATABLE,DIMENSION(:,:) :: DATAMAT
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID,rec_array
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:

  IF(PRESENT(y).AND.PRESENT(z)) THEN
   ALLOCATE(DATAMAT(N,3))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
   DATAMAT(:,3)=Z
  ELSE IF(PRESENT(y)) THEN
   ALLOCATE(DATAMAT(N,2))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
  ELSE
   ALLOCATE(DATAMAT(N,1))
   DATAMAT(:,1)=X
  END IF

  INQUIRE(IOLENGTH=rec_array) DATAMAT
  OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='NEW',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='REPLACE',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  ELSE
   FILESTATUS=1
  END IF

  WRITE(102,rec=1) (0*DATAMAT)
  WRITE(102,rec=2) DATAMAT

  CLOSE(102)

  RETURN
 END SUBROUTINE I8UFDATAFILE

 SUBROUTINE R4UFDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  REAL(4),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  REAL(4),DIMENSION(N),OPTIONAL :: y,z
  REAL(4),ALLOCATABLE,DIMENSION(:,:) :: DATAMAT
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID,rec_array
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:

  IF(PRESENT(y).AND.PRESENT(z)) THEN
   ALLOCATE(DATAMAT(N,3))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
   DATAMAT(:,3)=Z
  ELSE IF(PRESENT(y)) THEN
   ALLOCATE(DATAMAT(N,2))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
  ELSE
   ALLOCATE(DATAMAT(N,1))
   DATAMAT(:,1)=X
  END IF

  INQUIRE(IOLENGTH=rec_array) DATAMAT
  OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='NEW',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='REPLACE',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  ELSE
   FILESTATUS=1
  END IF

  WRITE(102,rec=1) (0.0*DATAMAT)
  WRITE(102,rec=2) DATAMAT

  CLOSE(102)

  RETURN
 END SUBROUTINE R4UFDATAFILE

 SUBROUTINE R8UFDATAFILE(autoName,N,filestatus,x,y,z)
  IMPLICIT NONE

  INTEGER, INTENT(IN) :: N
! MAIN Array Vector
  REAL(8),DIMENSION(N) :: x
! OPTIONAL Array Vectors
  REAL(8),DIMENSION(N),OPTIONAL :: y,z
  REAL(8),ALLOCATABLE,DIMENSION(:,:) :: DATAMAT
  INTEGER :: ferror,i,filestatus
  INTEGER :: autoID,rec_array
  CHARACTER(*) :: autoName

  FILESTATUS=0
! Importing the Data to the AUTODATAFILE:

  IF(PRESENT(y).AND.PRESENT(z)) THEN
   ALLOCATE(DATAMAT(N,3))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
   DATAMAT(:,3)=Z
  ELSE IF(PRESENT(y)) THEN
   ALLOCATE(DATAMAT(N,2))
   DATAMAT(:,1)=X
   DATAMAT(:,2)=Y
  ELSE
   ALLOCATE(DATAMAT(N,1))
   DATAMAT(:,1)=X
  END IF

  INQUIRE(IOLENGTH=rec_array) DATAMAT
  OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='NEW',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  IF(ferror.NE.0) THEN
   OPEN(UNIT=102,FILE=TRIM(AUTONAME),STATUS='REPLACE',form='UNFORMATTED',ACCESS='DIRECT',IOSTAT=ferror,RECL=rec_array)
  ELSE
   FILESTATUS=1
  END IF

  WRITE(102,rec=1) (0.0d0*DATAMAT)
  WRITE(102,rec=2) DATAMAT

  CLOSE(102)

  RETURN
 END SUBROUTINE R8UFDATAFILE


! SUBROUTINE FOR MESHGRIDING TWO OR THREE 1D VECTOR ARRAYS TO GIVE
! TWO 2D OR THREE 3D VECTOR ARRAYS.

 SUBROUTINE I4MESHGRID2D(XMAT1D,YMAT1D,XMAT2D,YMAT2D)
  IMPLICIT NONE
  INTEGER :: N1,N2,J,K
  INTEGER :: outMATDIMS(2)
  INTEGER(4), DIMENSION(:) :: XMAT1D,YMAT1D
  INTEGER(4), DIMENSION(:,:) :: XMAT2D,YMAT2D

  INTEGER(4), ALLOCATABLE, DIMENSION(:) :: eXMAT1D(:),eYMAT1D(:)

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)

  outMATDIMS=SHAPE(XMAT2D)
  IF(outMATDIMS(1).EQ.N1.AND.outMATDIMS(2).EQ.N2) THEN
   DO J=1,N1
    DO K=1,N2
     XMAT2D(J,K)=XMAT1D(J)
     YMAT2D(J,K)=YMAT1D(K)
    END DO
   END DO
  ELSE IF(outMATDIMS(1).NE.N1.OR.outMATDIMS(2).NE.N2) THEN
   ALLOCATE(eXMAT1D(outMATDIMS(1)))
   ALLOCATE(eYMAT1D(outMATDIMS(2)))
   CALL LINVECTOR(XMAT1D(1),XMAT1D(N1),outMATDIMS(1),eXMAT1D)
   CALL LINVECTOR(YMAT1D(1),YMAT1D(N2),outMATDIMS(2),eYMAT1D)
   DO J=1,outMATDIMS(1)
    DO K=1,outMATDIMS(2)
     XMAT2D(J,K)=eXMAT1D(J)
     YMAT2D(J,K)=eYMAT1D(K)
    END DO
   END DO
  END IF
      
  RETURN
 END SUBROUTINE I4MESHGRID2D

 SUBROUTINE I8MESHGRID2D(XMAT1D,YMAT1D,XMAT2D,YMAT2D)
  IMPLICIT NONE
  INTEGER :: N1,N2,J,K
  INTEGER :: outMATDIMS(2)
  INTEGER(8), DIMENSION(:) :: XMAT1D,YMAT1D
  INTEGER(8), DIMENSION(:,:) :: XMAT2D,YMAT2D

  INTEGER(8), ALLOCATABLE, DIMENSION(:) :: eXMAT1D(:),eYMAT1D(:)

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)

  outMATDIMS=SHAPE(XMAT2D)
  IF(outMATDIMS(1).EQ.N1.AND.outMATDIMS(2).EQ.N2) THEN
   DO J=1,N1
    DO K=1,N2
     XMAT2D(J,K)=XMAT1D(J)
     YMAT2D(J,K)=YMAT1D(K)
    END DO
   END DO
  ELSE IF(outMATDIMS(1).NE.N1.OR.outMATDIMS(2).NE.N2) THEN
   ALLOCATE(eXMAT1D(outMATDIMS(1)))
   ALLOCATE(eYMAT1D(outMATDIMS(2)))
   CALL LINVECTOR(XMAT1D(1),XMAT1D(N1),outMATDIMS(1),eXMAT1D)
   CALL LINVECTOR(YMAT1D(1),YMAT1D(N2),outMATDIMS(2),eYMAT1D)
   DO J=1,outMATDIMS(1)
    DO K=1,outMATDIMS(2)
     XMAT2D(J,K)=eXMAT1D(J)
     YMAT2D(J,K)=eYMAT1D(K)
    END DO
   END DO
  END IF
      
  RETURN
 END SUBROUTINE I8MESHGRID2D

 SUBROUTINE R4MESHGRID2D(XMAT1D,YMAT1D,XMAT2D,YMAT2D)
  IMPLICIT NONE
  INTEGER :: N1,N2,J,K
  INTEGER :: outMATDIMS(2)
  REAL(4), DIMENSION(:) :: XMAT1D,YMAT1D
  REAL(4), DIMENSION(:,:) :: XMAT2D,YMAT2D

  REAL(4), ALLOCATABLE, DIMENSION(:) :: eXMAT1D(:),eYMAT1D(:)

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)

  outMATDIMS=SHAPE(XMAT2D)
  IF(outMATDIMS(1).EQ.N1.AND.outMATDIMS(2).EQ.N2) THEN
   DO J=1,N1
    DO K=1,N2
     XMAT2D(J,K)=XMAT1D(J)
     YMAT2D(J,K)=YMAT1D(K)
    END DO
   END DO
  ELSE IF(outMATDIMS(1).NE.N1.OR.outMATDIMS(2).NE.N2) THEN
   ALLOCATE(eXMAT1D(outMATDIMS(1)))
   ALLOCATE(eYMAT1D(outMATDIMS(2)))
   CALL LINVECTOR(XMAT1D(1),XMAT1D(N1),outMATDIMS(1),eXMAT1D)
   CALL LINVECTOR(YMAT1D(1),YMAT1D(N2),outMATDIMS(2),eYMAT1D)
   DO J=1,outMATDIMS(1)
    DO K=1,outMATDIMS(2)
     XMAT2D(J,K)=eXMAT1D(J)
     YMAT2D(J,K)=eYMAT1D(K)
    END DO
   END DO
  END IF
      
  RETURN
 END SUBROUTINE R4MESHGRID2D

 SUBROUTINE R8MESHGRID2D(XMAT1D,YMAT1D,XMAT2D,YMAT2D)
  IMPLICIT NONE
  INTEGER :: N1,N2,J,K
  INTEGER :: outMATDIMS(2)
  REAL(8), DIMENSION(:)   :: XMAT1D,YMAT1D
  REAL(8), DIMENSION(:,:) :: XMAT2D,YMAT2D

  REAL(8), ALLOCATABLE, DIMENSION(:) :: eXMAT1D(:),eYMAT1D(:)

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)

  outMATDIMS=SHAPE(XMAT2D)
  IF(outMATDIMS(1).EQ.N1.AND.outMATDIMS(2).EQ.N2) THEN
   DO J=1,N1
    DO K=1,N2
     XMAT2D(J,K)=XMAT1D(J)
     YMAT2D(J,K)=YMAT1D(K)
    END DO
   END DO
  ELSE IF(outMATDIMS(1).NE.N1.OR.outMATDIMS(2).NE.N2) THEN
   ALLOCATE(eXMAT1D(outMATDIMS(1)))
   ALLOCATE(eYMAT1D(outMATDIMS(2)))
   CALL LINVECTOR(XMAT1D(1),XMAT1D(N1),outMATDIMS(1),eXMAT1D)
   CALL LINVECTOR(YMAT1D(1),YMAT1D(N2),outMATDIMS(2),eYMAT1D)
   DO J=1,outMATDIMS(1)
    DO K=1,outMATDIMS(2)
     XMAT2D(J,K)=eXMAT1D(J)
     YMAT2D(J,K)=eYMAT1D(K)
    END DO
   END DO
  END IF
      
  RETURN
 END SUBROUTINE R8MESHGRID2D


 SUBROUTINE I4MESHGRID3D(XMAT1D,YMAT1D,ZMAT1D,XMAT3D,YMAT3D,ZMAT3D)
  IMPLICIT NONE
  INTEGER(4)                   :: N1,N2,N3,I,J,K
  INTEGER(4), DIMENSION(:)     :: XMAT1D,YMAT1D,ZMAT1D
  INTEGER(4), DIMENSION(:,:,:) :: XMAT3D,YMAT3D,ZMAT3D

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)
  N3=SIZE(ZMAT1D)

  DO I=1,N1
   DO J=1,N2
    DO K=1,N3
     XMAT3D(I,J,K)=XMAT1D(I)
     YMAT3D(I,J,K)=YMAT1D(J)
     ZMAT3D(I,J,K)=ZMAT1D(K)
    END DO
   END DO
  END DO

  RETURN
 END SUBROUTINE I4MESHGRID3D


 SUBROUTINE I8MESHGRID3D(XMAT1D,YMAT1D,ZMAT1D,XMAT3D,YMAT3D,ZMAT3D)
  IMPLICIT NONE
  INTEGER(4)                   :: N1,N2,N3,I,J,K
  INTEGER(8), DIMENSION(:)     :: XMAT1D,YMAT1D,ZMAT1D
  INTEGER(8), DIMENSION(:,:,:) :: XMAT3D,YMAT3D,ZMAT3D

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)
  N3=SIZE(ZMAT1D)

  DO I=1,N1
   DO J=1,N2
    DO K=1,N3
     XMAT3D(I,J,K)=XMAT1D(I)
     YMAT3D(I,J,K)=YMAT1D(J)
     ZMAT3D(I,J,K)=ZMAT1D(K)
    END DO
   END DO
  END DO

  RETURN
 END SUBROUTINE I8MESHGRID3D


 SUBROUTINE R4MESHGRID3D(XMAT1D,YMAT1D,ZMAT1D,XMAT3D,YMAT3D,ZMAT3D)
  IMPLICIT NONE
  INTEGER(4)                :: N1,N2,N3,I,J,K
  REAL(4), DIMENSION(:)     :: XMAT1D,YMAT1D,ZMAT1D
  REAL(4), DIMENSION(:,:,:) :: XMAT3D,YMAT3D,ZMAT3D

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)
  N3=SIZE(ZMAT1D)

  DO I=1,N1
   DO J=1,N2
    DO K=1,N3
     XMAT3D(I,J,K)=XMAT1D(I)
     YMAT3D(I,J,K)=YMAT1D(J)
     ZMAT3D(I,J,K)=ZMAT1D(K)
    END DO
   END DO
  END DO

  RETURN
 END SUBROUTINE R4MESHGRID3D


 SUBROUTINE R8MESHGRID3D(XMAT1D,YMAT1D,ZMAT1D,XMAT3D,YMAT3D,ZMAT3D)
  IMPLICIT NONE
  INTEGER(4)                :: N1,N2,N3,I,J,K
  REAL(8), DIMENSION(:)     :: XMAT1D,YMAT1D,ZMAT1D
  REAL(8), DIMENSION(:,:,:) :: XMAT3D,YMAT3D,ZMAT3D

  N1=SIZE(XMAT1D)
  N2=SIZE(YMAT1D)
  N3=SIZE(ZMAT1D)

  DO I=1,N1
   DO J=1,N2
    DO K=1,N3
      XMAT3D(I,J,K)=XMAT1D(I)
      YMAT3D(I,J,K)=YMAT1D(J)
      ZMAT3D(I,J,K)=ZMAT1D(K)
    END DO
   END DO
  END DO

  RETURN
 END SUBROUTINE R8MESHGRID3D



! SUBROUTINE TO CREATE 1D VECTOR ARRAY FOR THE REQUIRED RANGE
! IT USED HERE THE STEP SIZE TO CREATE THE VECTOR ARRAY WITH THE
! START AND END POINTS OF THE RANGE OF DATA.
 SUBROUTINE I4VARVECTOR(A,B,STEP,MAT1D)
  IMPLICIT NONE
  INTEGER(4) :: A,B,STEP
  INTEGER :: N,K
  INTEGER(4), DIMENSION(:) :: MAT1D

  N=SIZE(MAT1D)
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE I4VARVECTOR
  
 SUBROUTINE I8VARVECTOR(A,B,STEP,MAT1D)
  IMPLICIT NONE
  INTEGER(8) :: A,B,STEP
  INTEGER :: N,K
  INTEGER(8), DIMENSION(:) :: MAT1D
 
  N=SIZE(MAT1D)
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE I8VARVECTOR
  
 SUBROUTINE R4VARVECTOR(A,B,STEP,MAT1D)
  IMPLICIT NONE
  REAL(4) :: A,B,STEP
  INTEGER :: N,K
  REAL(4), DIMENSION(:) :: MAT1D

  N=SIZE(MAT1D)
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE R4VARVECTOR
  
 SUBROUTINE R8VARVECTOR(A,B,STEP,MAT1D)
  IMPLICIT NONE
  REAL(8) :: A,B,STEP
  INTEGER :: N,K
  REAL(8), DIMENSION(:) :: MAT1D

  N=SIZE(MAT1D)
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE R8VARVECTOR
  


! SUBROUTINE TO CREATE 1D VECTOR ARRAY FOR THE REQUIRED RANGE
! IT USES THE NUMBER OF REQUIRED POINTS TO CREATE THE VECTOR 
! ARRAY WITH THE START AND END POINTS OF THE RANGE OF DATA.
! IF THE OPTIONAL VARIABLE FIXEDENDS IS SUPPLIED WITH A VALUE
! OF 1 IT WILL INCLUDE THE END POINTS TO THE ARRAY. OTHERWISE,
! ONLY THE FIRST POINT WILL BE INCLUDED INTO THE ARRAY.

 SUBROUTINE I4LINVECTOR (A,B,N,MAT1D,FixedEnds)
  IMPLICIT NONE
  INTEGER(4) :: A,B,STEP
  INTEGER :: N,K
  INTEGER(4), DIMENSION(:) :: MAT1D
  INTEGER(4), OPTIONAL :: FixedEnds
      
  IF(PRESENT(FixedEnds)) THEN
   IF(FixedEnds.EQ.1.AND.N.NE.1) THEN
    STEP=(B-A)/(N-1)
   ELSE
    STEP=(B-A)/N
   END IF
  ELSE
   STEP=(B-A)/N
  END IF
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE I4LINVECTOR
  
 SUBROUTINE I8LINVECTOR (A,B,N,MAT1D,FixedEnds)
  IMPLICIT NONE
  INTEGER(8) :: A,B,STEP
  INTEGER :: N,K
  INTEGER(8), DIMENSION(:) :: MAT1D
  INTEGER(4), OPTIONAL :: FixedEnds
      
  IF(PRESENT(FixedEnds)) THEN
   IF(FixedEnds.EQ.1.AND.N.NE.1) THEN
    STEP=(B-A)/(N-1)
   ELSE
    STEP=(B-A)/N
   END IF
  ELSE
   STEP=(B-A)/N
  END IF
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE I8LINVECTOR
  
 SUBROUTINE R4LINVECTOR (A,B,N,MAT1D,FixedEnds)
  IMPLICIT NONE
  REAL(4) :: A,B,STEP
  INTEGER :: N,K
  REAL(4), DIMENSION(:) :: MAT1D
  INTEGER(4), OPTIONAL :: FixedEnds
      
  IF(PRESENT(FixedEnds)) THEN
   IF(FixedEnds.EQ.1.AND.N.NE.1) THEN
    STEP=(B-A)/REAL(N-1)
   ELSE
    STEP=(B-A)/REAL(N)
   END IF
  ELSE
   STEP=(B-A)/REAL(N)
  END IF
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE R4LINVECTOR
  
 SUBROUTINE R8LINVECTOR (A,B,N,MAT1D,FixedEnds)
  IMPLICIT NONE
  REAL(8) :: A,B,STEP
  INTEGER :: N,K
  REAL(8), DIMENSION(:) :: MAT1D
  INTEGER(4), OPTIONAL :: FixedEnds
      
  IF(PRESENT(FixedEnds)) THEN
   IF(FixedEnds.EQ.1.AND.N.NE.1) THEN
    STEP=(B-A)/DBLE(N-1)
   ELSE
    STEP=(B-A)/DBLE(N)
   END IF
  ELSE
   STEP=(B-A)/DBLE(N)
  END IF
  DO K=1,N
   MAT1D(K)=A+((K-1)*STEP)
  END DO

  RETURN
 END SUBROUTINE R8LINVECTOR


! SUBROUTINE TO CREATE THE mainPY.py PYTHON CODED FILE
! THAT YOU CAN RUN AFTER THE EXCUSION OF YOUR FORTRAN CODE TO
! EXECUTE ALL THE PYTHON CODED FILES THAT CREATE THE PLOTS OF
! ALL GROUPS OF DATAFILES YOU CREATED IN YOUR FORTRAN CODE.
 SUBROUTINE BUILDMAINPY(FNAME,DOTPYSAVE)
  IMPLICIT NONE
  CHARACTER(*)        :: FNAME
  CHARACTER*150       :: TEMPTEXT1,TEMPTEXT2
  CHARACTER*3         :: num2str1,num2str2
  INTEGER(4)          :: ferror,FNL
  INTEGER(4),OPTIONAL :: DOTPYSAVE
  LOGICAL             :: FLAG
  INTEGER(4), SAVE    :: ACCESSID=1

  IF(ACCESSID.NE.1) THEN
   FNL=LEN_TRIM(FNAME)
   TEMPTEXT1="./"//FNAME(1:FNL-8)//".py"
   inquire(file=TRIM(TEMPTEXT1), exist=flag)

   IF(.NOT.FLAG) THEN 
!   Modifying the Data File to the mainPy.py:
    OPEN(UNIT=100,FILE='mainPy.py',STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
    IF (ferror.NE.0) THEN
     OPEN(UNIT=100,FILE='mainPy.py',STATUS='OLD',ACTION='WRITE',ACCESS="APPEND",IOSTAT=ferror)
    END IF

    TEMPTEXT2="os.system('python "//TRIM(TEMPTEXT1)//"')"
    WRITE(100,TRIM(STRFMT(LEN(TRIM(TEMPTEXT2))))) TRIM(TEMPTEXT2)
    IF(PRESENT(DOTPYSAVE).AND.DOTPYSAVE.EQ.0) THEN
     TEMPTEXT2="os.system('rm "//TRIM(TEMPTEXT1)//"')"
     WRITE(100,TRIM(STRFMT(LEN(TRIM(TEMPTEXT2))))) TRIM(TEMPTEXT2)
    END IF

    CLOSE(UNIT=100)
   END IF
  ELSE
!  Creating/Initializing the Data File to the mainPy.py:
   OPEN(UNIT=100,FILE='mainPy.py',STATUS='NEW',ACTION='WRITE',IOSTAT=ferror)
   IF (ferror.NE.0) THEN
    OPEN(UNIT=100,FILE='mainPy.py',STATUS='REPLACE',ACTION='WRITE',IOSTAT=ferror)
   END IF
   WRITE(100,'("import os, sys")')
   WRITE(100,*) ""
   WRITE(100,*) ""

   FNL=LEN_TRIM(FNAME)
   TEMPTEXT1=FNAME(1:FNL-8)//".py"
   TEMPTEXT2="os.system('python ./"//TRIM(TEMPTEXT1)//"')"
   WRITE(100,TRIM(STRFMT(LEN(TRIM(TEMPTEXT2))))) TRIM(TEMPTEXT2)
   IF(PRESENT(DOTPYSAVE).AND.DOTPYSAVE.EQ.0) THEN
    TEMPTEXT2="os.system('rm "//TRIM(TEMPTEXT1)//"')"
    WRITE(100,TRIM(STRFMT(LEN(TRIM(TEMPTEXT2))))) TRIM(TEMPTEXT2)
   END IF
   CLOSE(UNIT=100)
  END IF 
      
  ACCESSID = ACCESSID+1

  RETURN
 END SUBROUTINE BUILDMAINPY
      

! SUBTOUTINE TO CREATE A PYTHON CODED FILE TO PLOT THE DATA OF
! A CERTAIN GROUP OF DATA FILES YOU CREATED IN YOUR FORTRAN CODE.

 SUBROUTINE DOTPY(autoName,N,MATDIM,GFC,GA,GX)
  IMPLICIT NONE
  INTEGER, DIMENSION(:), INTENT(IN) :: GFC
  INTEGER, INTENT(IN) :: MATDIM(2),N
  INTEGER :: UFMATDIM(2)
  INTEGER :: N1
  INTEGER :: G,SG,GID,NFPS,DPI,PNG,PDF,DF,DFtype,Dtype,YYAxes
  INTEGER :: match1,match2,match3,match4
  INTEGER :: EOFCHK,ferror,CHARLEN,FNL,FLAG3D,I,GAN
  CHARACTER(*) :: AUTONAME
  CHARACTER(*) :: GA(:)
  CHARACTER(*),OPTIONAL :: GX(:)
  CHARACTER*200 :: TEMPTEXT
  CHARACTER*200 :: TEMPTEXT1,TEMPTEXT2
  CHARACTER*200 :: TEMPTEXT3,TEMPTEXT4
  CHARACTER*200 :: TEMPTEXT5
  CHARACTER*10 :: vMIN,vMAX,vAVG
  LOGICAL :: IFLAG=.FALSE.


  IF(SIZE(GFC).LT.11) THEN
   WRITE(*,*) "ERROR@FORTGRAPHER: GFC ARRAY SIZE MUST BE EQUAL OR LARGER THAN 11"
   STOP
  END IF
  G=GFC(1);SG=GFC(2);GID=GFC(3)
  NFPS=GFC(4);DPI=GFC(5)
  PNG=GFC(6);PDF=GFC(7)
  DF=GFC(8);DFtype=GFC(9);YYAxes=GFC(10)
  Dtype=GFC(SIZE(GFC))

  N1=MATDIM(1)

  IF(DFtype.EQ.2) THEN
   IF(N.EQ.1) THEN
    UFMATDIM(1)=MATDIM(1)*MATDIM(2)
    UFMATDIM(2)=1
   ELSEIF(N.EQ.2) THEN
    UFMATDIM(1)=MATDIM(1)*MATDIM(2)
    UFMATDIM(2)=2
   ELSEIF(N.EQ.3) THEN
    UFMATDIM(1)=MATDIM(1)*MATDIM(2)
    UFMATDIM(2)=3
   END IF
  END IF

  GAN=SIZE(GA)

  FLAG3D=0
  TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""
! Creating/Initializing/Adding the Data File to the mainPy.py:
  FNL=LEN_TRIM(AUTONAME)
  TEMPTEXT="./"//AUTONAME(1:FNL-8)//".py"
  OPEN(UNIT=101,FILE=TRIM(TEMPTEXT),STATUS='OLD',ACTION='READWRITE',ACCESS='APPEND',IOSTAT=ferror)
  IF(ferror/=0) THEN
   OPEN(UNIT=101,FILE=TRIM(TEMPTEXT),STATUS='NEW',ACTION='READWRITE',IOSTAT=ferror)
   TEMPTEXT="from matplotlib import *"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="import os, sys"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="import matplotlib"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="matplotlib.use(""Agg"")"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="from matplotlib.backends.backend_pdf import *"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="import matplotlib.pyplot as pltpng"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="from pylab import *"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="from numpy import *"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="from matplotlib import cm"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="import matplotlib.ticker as ticker"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="from mpl_toolkits.mplot3d import Axes3D"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

   TEMPTEXT="def importData(dfilename,N1,Dtype):"  
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    if Dtype == 1:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='int32'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 2:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='int64'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 3:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='float32'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 4:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='float64'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    filehandle=open(dfilename,'rb')"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    dataTest=len(str.rsplit(filehandle.readline()))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    filehandle.seek(0)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    x=[]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    y=[]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    z=[]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    rawData=filehandle.readlines()"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    if dataTest == 3:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        for line in rawData:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            temp=str.rsplit(line)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            try:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                x.append(temp[0])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                y.append(temp[1])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                z.append(temp[2])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            except ValueError:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                pass"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif dataTest == 2:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        for line in rawData:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            temp=str.rsplit(line)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            try:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                x.append(temp[0])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                y.append(temp[1])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            except ValueError:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                pass"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    else:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        for line in rawData:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            temp=str.rsplit(line)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            try:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                x.append(temp[0])"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="            except ValueError:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="                pass"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    filehandle.close()"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    test=zeros(len(x))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    if dataTest == 3:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=array(x)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=x.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        N=len(x)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        N2=int(N/N1)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        X=resize(x,(N1,N2))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        y=array(y)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        y=y.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        Y=resize(y,(N1,N2))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        z=array(z)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        z=z.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        Z=resize(z,(N1,N2))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        return [X,Y,Z]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif dataTest == 2:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=array(x)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=x.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        y=array(y)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        y=y.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        return [x,y]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    else:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=array(x)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        x=x.astype(dt)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        return [x]"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)

   TEMPTEXT="def readufdatafile(inputfilename,nx,ny,Dtype):"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    if Dtype == 1:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='int32'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        matdatasize=4*nx*ny"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 2:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='int64'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        matdatasize=8*nx*ny"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 3:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='float32'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        matdatasize=4*nx*ny"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    elif Dtype == 4:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        dt='float64'"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        matdatasize=8*nx*ny"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    f = open(inputfilename,'rb')"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    f.seek(matdatasize)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    field = np.fromfile(f,dtype=dt,count=nx*ny)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    field = np.reshape(field,(nx,ny))"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    f.close()"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    return field"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)

   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)
   FNL=LEN_TRIM(AUTONAME)
   TEMPTEXT1="print 'GRAPHICS FILE: "//AUTONAME(1:FNL-8)
   TEMPTEXT2=".py IS PROCESSING ...'"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)

!********************* For Multiple Y axes ***********************
   TEMPTEXT="def make_patch_spines_invisible(ax):"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    ax.set_frame_on(True)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    ax.patch.set_visible(False)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="    for sp in ax.spines.itervalues():"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT="        sp.set_visible(False)"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)
   TEMPTEXT=""
   WRITE(101,*) TRIM(TEMPTEXT)

   IF(PDF.NE.0) THEN
    FNL=LEN_TRIM(AUTONAME)
    TEMPTEXT="pp = PdfPages('"//AUTONAME(1:FNL-8)//".pdf')"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF

   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

   IF(GAN.GE.65.AND.TRIM(GA(65)).NE."") THEN
    TEMPTEXT="cbarticks="//TRIM(GA(65))
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF
   IF(GAN.GE.66.AND.TRIM(GA(66)).NE."") THEN
    TEMPTEXT="cbarlevels=list(linspace("//TRIM(GA(63))//","//TRIM(GA(64))//","//TRIM(GA(66))//"))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF
   IF(GAN.GE.67.AND.(TRIM(GA(67)).EQ."yes".OR.TRIM(GA(67)).EQ."YES")) THEN
    TEMPTEXT="cbarnorm=matplotlib.colors.Normalize(vmin="//TRIM(GA(63))//",vmax="//TRIM(GA(64))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF

   TEMPTEXT=""
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

  ELSE
   BACKSPACE(101)
   BACKSPACE(101)
   BACKSPACE(101)
   BACKSPACE(101)
   BACKSPACE(101)
   BACKSPACE(101)

   IF(GID.NE.1) THEN
    TEMPTEXT=""
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF

  END IF

  IF(DFtype.EQ.2) THEN
   IF((UFMATDIM(1)/1000000000).GE.1) THEN
    WRITE(vMAX,'(I10)') N1
   ELSEIF((UFMATDIM(1)/100000000).GE.1) THEN
    WRITE(vMAX,'(I9)') N1
   ELSEIF((UFMATDIM(1)/10000000).GE.1) THEN
    WRITE(vMin,'(I8)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/1000000).GE.1) THEN
    WRITE(vMin,'(I7)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/100000).GE.1) THEN
    WRITE(vMin,'(I6)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/10000).GE.1) THEN
    WRITE(vMin,'(I5)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/1000).GE.1) THEN
    WRITE(vMin,'(I4)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/100).GE.1) THEN
    WRITE(vMin,'(I3)') UFMATDIM(1)
   ELSEIF((UFMATDIM(1)/10).GE.1) THEN
    WRITE(vMin,'(I2)') UFMATDIM(1)
   ELSE
    WRITE(vMin,'(I1)') UFMATDIM(1)
   ENDIF
   IF((UFMATDIM(2)/1000000000).GE.1) THEN
    WRITE(vMAX,'(I10)') N1
   ELSEIF((UFMATDIM(2)/100000000).GE.1) THEN
    WRITE(vMAX,'(I9)') N1
   ELSEIF((UFMATDIM(2)/10000000).GE.1) THEN
    WRITE(vMin,'(I8)') UFMATDIM(1)
   ELSEIF((UFMATDIM(2)/1000000).GE.1) THEN
    WRITE(vMin,'(I7)') UFMATDIM(1)
   ELSEIF((UFMATDIM(2)/100000).GE.1) THEN
    WRITE(vMin,'(I6)') UFMATDIM(1)
   ELSEIF((UFMATDIM(2)/10000).GE.1) THEN
    WRITE(vMAX,'(I5)') UFMATDIM(2)
   ELSEIF((UFMATDIM(2)/1000).GE.1) THEN
    WRITE(vMAX,'(I4)') UFMATDIM(2)
   ELSEIF((UFMATDIM(2)/100).GE.1) THEN
    WRITE(vMAX,'(I3)') UFMATDIM(2)
   ELSEIF((UFMATDIM(2)/10).GE.1) THEN
    WRITE(vMAX,'(I2)') UFMATDIM(2)
   ELSE
    WRITE(vMAX,'(I1)') UFMATDIM(2)
   ENDIF
   WRITE(vAVG,'(I1)') Dtype

   TEMPTEXT="try:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT1=" a=readufdatafile('"
   TEMPTEXT2=AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL)//"',"
   TEMPTEXT3=TRIM(vMax)//","//TRIM(vMin)//","//TRIM(vAVG)//")"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

   TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""

   IF(N.EQ.3) THEN
    IF((MATDIM(1)/1000000000).GE.1) THEN
     WRITE(vMin,'(I10)') MATDIM(1)
    ELSEIF((MATDIM(1)/100000000).GE.1) THEN
     WRITE(vMin,'(I9)') MATDIM(1)
    ELSEIF((MATDIM(1)/10000000).GE.1) THEN
     WRITE(vMin,'(I8)') MATDIM(1)
    ELSEIF((MATDIM(1)/1000000).GE.1) THEN
     WRITE(vMin,'(I7)') MATDIM(1)
    ELSEIF((MATDIM(1)/100000).GE.1) THEN
     WRITE(vMin,'(I6)') MATDIM(1)
    ELSEIF((MATDIM(1)/10000).GE.1) THEN
     WRITE(vMin,'(I5)') MATDIM(1)
    ELSEIF((MATDIM(1)/1000).GE.1) THEN
     WRITE(vMin,'(I4)') MATDIM(1)
    ELSEIF((MATDIM(1)/100).GE.1) THEN
     WRITE(vMin,'(I3)') MATDIM(1)
    ELSEIF((MATDIM(1)/10).GE.1) THEN
     WRITE(vMin,'(I2)') MATDIM(1)
    ELSE
     WRITE(vMin,'(I1)') MATDIM(1)
    ENDIF
    IF((MATDIM(2)/1000000000).GE.1) THEN
     WRITE(vMAX,'(I10)') MATDIM(2)
    ELSEIF((MATDIM(2)/100000000).GE.1) THEN
     WRITE(vMAX,'(I9)') MATDIM(2)
    ELSEIF((MATDIM(2)/10000000).GE.1) THEN
     WRITE(vMAX,'(I8)') MATDIM(2)
    ELSEIF((MATDIM(2)/1000000).GE.1) THEN
     WRITE(vMAX,'(I7)') MATDIM(2)
    ELSEIF((MATDIM(2)/100000).GE.1) THEN
     WRITE(vMAX,'(I6)') MATDIM(2)
    ELSEIF((MATDIM(2)/10000).GE.1) THEN
     WRITE(vMAX,'(I5)') MATDIM(2)
    ELSEIF((MATDIM(2)/1000).GE.1) THEN
     WRITE(vMAX,'(I4)') MATDIM(2)
    ELSEIF((MATDIM(2)/100).GE.1) THEN
     WRITE(vMAX,'(I3)') MATDIM(2)
    ELSEIF((MATDIM(2)/10).GE.1) THEN
     WRITE(vMAX,'(I2)') MATDIM(2)
    ELSE
     WRITE(vMAX,'(I1)') MATDIM(2)
    ENDIF

    TEMPTEXT=" x=numpy.asarray(a[0])"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" x=resize(x,("//TRIM(vMin)//","//TRIM(VMax)//"))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" y=numpy.asarray(a[1])"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" y=resize(y,("//TRIM(vMin)//","//TRIM(VMax)//"))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" z=numpy.asarray(a[2])"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" z=resize(z,("//TRIM(vMin)//","//TRIM(VMax)//"))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

   ELSEIF(N.EQ.2) THEN
    IF(YYAxes.EQ.1) THEN
     TEMPTEXT=" x1=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y1=numpy.asarray(a[1])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.2) THEN
     TEMPTEXT=" x2=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y2=numpy.asarray(a[1])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.3) THEN
     TEMPTEXT=" x3=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y3=numpy.asarray(a[1])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=" x=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y=numpy.asarray(a[1])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
   ELSEIF(N.EQ.1) THEN
    IF(YYAxes.EQ.1) THEN
     TEMPTEXT=" x1=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.2) THEN
     TEMPTEXT=" x2=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.3) THEN
     TEMPTEXT=" x3=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=" x=numpy.asarray(a[0])"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
   END IF

  ELSE
   IF((N1/1000000000).GE.1) THEN
    WRITE(vMAX,'(I10)') N1
   ELSEIF((N1/100000000).GE.1) THEN
    WRITE(vMAX,'(I9)') N1
   ELSEIF((N1/10000000).GE.1) THEN
    WRITE(vMAX,'(I8)') N1
   ELSEIF((N1/1000000).GE.1) THEN
    WRITE(vMAX,'(I7)') N1
   ELSEIF((N1/100000).GE.1) THEN
    WRITE(vMAX,'(I6)') N1
   ELSEIF((N1/10000).GE.1) THEN
    WRITE(vMAX,'(I5)') N1
   ELSEIF((N1/1000).GE.1) THEN
    WRITE(vMAX,'(I4)') N1
   ELSEIF((N1/100).GE.1) THEN
    WRITE(vMAX,'(I3)') N1
   ELSEIF((N1/10).GE.1) THEN
    WRITE(vMAX,'(I2)') N1
   ELSE
    WRITE(vMAX,'(I1)') N1
   ENDIF
   WRITE(vMin,'(I1)') Dtype

   TEMPTEXT="try:"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT1=" D1=importData('./"
   TEMPTEXT2=AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL)//"',"
   TEMPTEXT3=TRIM(vMax)//","//TRIM(vMin)//")"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   IF(N.EQ.3) THEN
    TEMPTEXT=" x=D1[0]"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" y=D1[1]"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" z=D1[2]"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ELSE IF(N.EQ.2) THEN
    IF(YYAxes.EQ.1) THEN
     TEMPTEXT=" x1=D1[0]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y1=D1[1]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.2) THEN
     TEMPTEXT=" x2=D1[0]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y2=D1[1]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(YYAxes.EQ.3) THEN
     TEMPTEXT=" x3=D1[0]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y3=D1[1]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=" x=D1[0]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT=" y=D1[1]"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ELSE
    TEMPTEXT=" x=D1[0]"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF
  END IF

  TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""

  IF(TRIM(GA(1)).EQ."SELF".OR.TRIM(GA(1)).EQ."self") THEN
   DO I=2,SIZE(GA) 
    WRITE(101,TRIM(STRFMT(LEN(TRIM(GA(I)))))) TRIM(GA(I))
   END DO
  ELSE
   IF((G/1E5).GE.1) THEN
    WRITE(vMIN,'(I6)') G
   ELSEIF((G/1E4).GE.1) THEN
    WRITE(vMIN,'(I5)') G
   ELSEIF((G/1E3).GE.1) THEN
    WRITE(vMIN,'(I4)') G
   ELSEIF((G/1E2).GE.1) THEN
    WRITE(vMIN,'(I3)') G
   ELSEIF((G/1E1).GE.1) THEN
    WRITE(vMIN,'(I2)') G
   ELSEIF((G/1E0).GE.1) THEN
    WRITE(vMIN,'(I1)') G
   ENDIF

   IF((DPI/100).GE.1) THEN
    WRITE(vMAX,'(I3)') DPI
   ELSEIF((DPI/10).GE.1) THEN
    WRITE(vMAX,'(I2)') DPI
   ELSEIF(DPI.GE.1) THEN
    WRITE(vMAX,'(I1)') DPI
   ENDIF

   IF(DPI.NE.0.AND.YYAxes.EQ.0) THEN
    TEMPTEXT1=" fig=figure("//TRIM(vMIN)//",dpi="//TRIM(vMAX)
    IF(GAN.GE.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",facecolor='" //TRIM(GA(27))//"'"
    ENDIF
    IF(GAN.GE.28.AND.GA(28).NE."") THEN
     TEMPTEXT3=",edgecolor='"//TRIM(GA(28))//"'"
    ENDIF
    IF(GAN.GE.29.AND.GA(29).NE."") THEN
     TEMPTEXT4=",figsize="//TRIM(GA(29))
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT4)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ELSEIF(YYAxes.EQ.0) THEN
    TEMPTEXT1=" fig=figure("//TRIM(vMIN)
    IF(GAN.GE.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",facecolor='" //TRIM(GA(27))//"'"
    ENDIF
    IF(GAN.GE.28.AND.GA(28).NE."") THEN
     TEMPTEXT3=",edgecolor='"//TRIM(GA(28))//"'"
    ENDIF
    IF(GAN.GE.29.AND.GA(29).NE."") THEN
     TEMPTEXT4=",figsize="//TRIM(GA(29))
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT4)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF

  IF (N==3) THEN
   IF(TRIM(GA(1)).EQ."surface".OR.TRIM(GA(1)).EQ."") THEN
    TEMPTEXT1=" ax=Axes3D(fig)"
    FLAG3D=1
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT1))))) TRIM(TEMPTEXT1)
    TEMPTEXT1=" cset1=ax.plot_surface(x,y,z"
    IF(GAN.GE.30.AND.TRIM(GA(30)).NE."") THEN
     TEMPTEXT2=",rstride=" // TRIM(GA(30))
    ELSE
     TEMPTEXT2=",rstride=1"
    ENDIF
    IF(GAN.GE.31.AND.TRIM(GA(31)).NE."") THEN
     TEMPTEXT3=",cstride" // TRIM(GA(31))
    ELSE
     TEMPTEXT3=",cstride=1"
    ENDIF
    IF(GAN.GE.32.AND.TRIM(GA(32)).NE."") THEN
     TEMPTEXT4=",alpha=" // TRIM(GA(32))
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT4)
    IF(GAN.GE.62.AND.TRIM(GA(62)).NE."") THEN
     TEMPTEXT1=",cmap=cm."//TRIM(GA(62))
    ELSE
     TEMPTEXT1=",cmap=cm.jet"
    END IF
    TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)
    IF(GAN.GE.63.AND.TRIM(GA(63)).NE."") THEN
     TEMPTEXT1=",vmin="//TRIM(GA(63))
    ELSE
     TEMPTEXT1=""
    END IF
    IF(GAN.GE.64.AND.TRIM(GA(64)).NE."") THEN
     TEMPTEXT2=",vmax="//TRIM(GA(64))
    ELSE
     TEMPTEXT2=""
    END IF
    TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ELSEIF(TRIM(GA(1)).EQ."contour3d") THEN
    TEMPTEXT1=" ax=Axes3D(fig)"
    FLAG3D=1
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT1))))) TRIM(TEMPTEXT1)
    TEMPTEXT=" cset1=ax.contour3d(x,y,z"
    IF(GAN.GE.62.AND.TRIM(GA(62)).NE."") THEN
     TEMPTEXT1=",cmap=cm."//TRIM(GA(62))
    ELSE
     TEMPTEXT1=",cmap=cm.jet"
    END IF
    TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)
    IF(GAN.GE.63.AND.TRIM(GA(63)).NE."") THEN
     TEMPTEXT1=",vmin="//TRIM(GA(63))
    ELSE
     TEMPTEXT1=""
    END IF
    IF(GAN.GE.64.AND.TRIM(GA(64)).NE."") THEN
     TEMPTEXT2=",vmax="//TRIM(GA(64))
    ELSE
     TEMPTEXT2=""
    END IF
    TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ELSEIF(TRIM(GA(1)).EQ."contourf") THEN
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" ax=fig.add_subplot("//TRIM(vMIN)
    IF(GAN.EQ.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='"//TRIM(GA(27))//"'"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    IF(GAN.GE.69.AND.TRIM(GA(69)).NE."") THEN
     TEMPTEXT=" cbarlevels="//TRIM(GA(69))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
    IF(GAN.GE.70.AND.TRIM(GA(70)).NE."") THEN
     TEMPTEXT=" cbarnorm="//TRIM(GA(70))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
    TEMPTEXT1=" cset1=pltpng.contourf(x,y,z"
    IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
     TEMPTEXT2=",colors='"//TRIM(GA(21))//"'"
    ENDIF
    IF(GAN.GE.61.AND.TRIM(GA(61)).EQ."yes") THEN
     TEMPTEXT3=",locator=ticker.LogLocator()"
    END IF
    IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4=""
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)
     IF(GAN.GE.62.AND.TRIM(GA(62)).NE."") THEN
      TEMPTEXT1=",cmap=cm."//TRIM(GA(62))
     ELSE
      TEMPTEXT1=",cmap=cm.jet"
     END IF
     TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)
     IF(GAN.GE.63.AND.TRIM(GA(63)).NE."") THEN
      TEMPTEXT1=",vmin="//TRIM(GA(63))
     ELSE
      TEMPTEXT1=""
     END IF
     IF(GAN.GE.64.AND.TRIM(GA(64)).NE."") THEN
      TEMPTEXT2=",vmax="//TRIM(GA(64))
     ELSE
      TEMPTEXT2=""
     END IF
     TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
     IF((GAN.GE.66.AND.TRIM(GA(66)).NE."").OR.(GAN.GE.69.AND.TRIM(GA(69)).NE."")) THEN
      TEMPTEXT=TRIM(TEMPTEXT)//",levels=cbarlevels"
     END IF
     IF((GAN.GE.67.AND.TRIM(GA(67)).NE."").OR.(GAN.GE.70.AND.TRIM(GA(70)).NE."")) THEN
      TEMPTEXT=TRIM(TEMPTEXT)//",norm=cbarnorm"
     END IF
      TEMPTEXT=TRIM(TEMPTEXT)//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ELSEIF(TRIM(GA(1)).EQ."contour") THEN
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" ax=fig.add_subplot("//TRIM(vMIN)
    IF(GAN.EQ.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='"//TRIM(GA(27))//"'"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    TEMPTEXT1=" cset1=pltpng.contour(x,y,z"
    IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
     TEMPTEXT2=",colors='"//TRIM(GA(21))//"'"
    ENDIF
    IF(GAN.GE.22.AND.TRIM(GA(22)).NE."") THEN
     TEMPTEXT3=",linewidth="//TRIM(GA(22))
    ENDIF
    IF(GAN.GE.61.AND.TRIM(GA(61)).EQ."yes") THEN
     TEMPTEXT4=",locator=ticker.LogLocator()"
    END IF
    IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT4)//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4=""
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)
     IF(GAN.GE.62.AND.TRIM(GA(62)).NE."") THEN
      TEMPTEXT1=",cmap=cm."//TRIM(GA(62))
     ELSE
      TEMPTEXT1=",cmap=cm.jet"
     END IF
     TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)
     IF(GAN.GE.63.AND.TRIM(GA(63)).NE."") THEN
      TEMPTEXT1=",vmin="//TRIM(GA(63))
     ELSE
      TEMPTEXT1=""
     END IF
     IF(GAN.GE.64.AND.TRIM(GA(64)).NE."") THEN
      TEMPTEXT2=",vmax="//TRIM(GA(64))
     ELSE
      TEMPTEXT2=""
     END IF
     TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    IF(GAN.GE.47.AND.TRIM(GA(47)).EQ."yes") THEN
     TEMPTEXT1=" clabel(cset1"
     IF(GAN.GE.48.AND.TRIM(GA(48)).NE."") THEN
      TEMPTEXT2=",fontsize="//TRIM(GA(48))
     ENDIF
     IF(GAN.GE.49.AND.TRIM(GA(49)).NE."") THEN
      TEMPTEXT3=",inline="//TRIM(GA(49))
     ELSE
      TEMPTEXT3=",inline=0.1"
     ENDIF
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ELSEIF(TRIM(GA(1)).EQ."wireframe") THEN
    TEMPTEXT=" ax=Axes3D(fig)"
    FLAG3D=1
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" cset1=ax.plot_wireframe(x,y,z)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ELSEIF(TRIM(GA(1)).EQ."plot3d") THEN
    TEMPTEXT=" ax=Axes3D(fig)"
    FLAG3D=1
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" cset1=ax.plot_plot3d(x,y,z)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ELSEIF(TRIM(GA(1)).EQ."scatter") THEN
    TEMPTEXT=" cset1=scatter(x,y,c=z)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ELSE
    TEMPTEXT=" cset1=pltpng.contour(x,y,z)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ENDIF
   IF(GAN.GE.50.AND.TRIM(GA(50)).NE."") THEN
    IF(TRIM(GA(50)).EQ."xy".OR.TRIM(GA(50)).EQ."yx") THEN
     TEMPTEXT=" cset=ax.contour(x, y, z, zdir='z')"
    ELSEIF(TRIM(GA(50)).EQ."yz".OR.TRIM(GA(50)).EQ."zy") THEN
     TEMPTEXT=" cset=ax.contour(x, y, z, zdir='x')"
    ELSEIF(TRIM(GA(50)).EQ."xz".OR.TRIM(GA(50)).EQ."zx") THEN
     TEMPTEXT=" cset=ax.contour(x, y, z, zdir='y')"
    ENDIF
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
   ENDIF
   IF(GID.EQ.1) THEN
    IF(PNG.EQ.0.AND.DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm -r "//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".*')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(PNG.EQ.0.AND.NFPS.NE.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".png')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".dat')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
    TEMPTEXT=" hold"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
   END IF
   TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
  ELSEIF(N==2) THEN
   IF(YYAxes.EQ.1) THEN
    IF(DPI.NE.0) THEN
     TEMPTEXT1=" fig=figure("//TRIM(vMIN)//",dpi="//TRIM(vMAX)
     TEMPTEXT2=",figsize=(17,12))"
    ELSE
     TEMPTEXT1=" fig=figure("//TRIM(vMIN)
     TEMPTEXT2=",figsize=(17,12))"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" GHost=subplot("//TRIM(vMIN)
    IF(GAN.GE.25.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='" //TRIM(GA(27))//"')"
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT1)//")"
    ENDIF
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p0,=GHost.plot(x1,y1,""b-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.2.AND.TRIM(GA(2)).NE."") THEN
     TEMPTEXT5=' GHost.set_title("' // TRIM(GA(2)) // '"'
     IF(GAN.GE.3.AND.TRIM(GA(3)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(3))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ')'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
    IF(GAN.GE.4.AND.TRIM(GA(4)).NE."") THEN
     TEMPTEXT5=' GHost.set_xlabel("' // TRIM(GA(4)) // '"'
     IF(GAN.GE.5.AND.TRIM(GA(5)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(5))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',va="top")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' GHost.set_ylabel("' // TRIM(GA(6)) // '"'
     IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" GHost.yaxis.label.set_color(p0.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.10.AND.TRIM(GA(10)).NE."") THEN
     TEMPTEXT=' GHost.set_xlim'//TRIM(GA(10))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' GHost.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    RETURN
   ELSEIF(YYAxes.EQ.2) THEN
    TEMPTEXT=" par1 = GHost.twinx()"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p1,=par1.plot(x2,y2,""g-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" make_patch_spines_invisible(par1)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" par1.spines['right'].set_position(('axes', 1.05))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" par1.spines['right'].set_visible(True)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' par1.set_ylabel("' // TRIM(GA(6)) // '"'
    IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" par1.yaxis.label.set_color(p1.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' par1.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    RETURN
   ELSEIF(YYAxes.EQ.3) THEN
    TEMPTEXT=" par2 = GHost.twinx()"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p2,=par2.plot(x3,y3,""r-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' par2.set_ylabel("' // TRIM(GA(6)) // '"'
     IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" par2.yaxis.label.set_color(p2.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' par2.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ELSE
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" ax=fig.add_subplot("//TRIM(vMIN)
    IF(GAN.EQ.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='"//TRIM(GA(27))//"'"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    TEMPTEXT5=""
    IF(TRIM(GA(1)).EQ."plot".OR.TRIM(GA(1)).EQ."") THEN
     TEMPTEXT1=" plot(x,y"
     IF(GAN.GE.20.AND.TRIM(GA(20)).NE."") THEN
      TEMPTEXT5=",label='" // TRIM(GA(20)) // "'"
     ENDIF
     IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
      TEMPTEXT2=",'" // TRIM(GA(21)) // "'"
     ENDIF
     IF(GAN.GE.22.AND.TRIM(GA(22)).NE."") THEN
      TEMPTEXT3=",linewidth=" // TRIM(GA(22))
     ENDIF
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT5) // ')'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ."scatter") THEN
     TEMPTEXT=' scatter(x,y)'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ.'semilog') THEN
     TEMPTEXT=" semilogy(x,y)"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ."loglog") THEN
     IF(GAN.GE.20.AND.TRIM(GA(20)).NE."") THEN
      TEMPTEXT=" loglog(x,y,label='" // TRIM(GA(20)) // "')"
     ELSE
      TEMPTEXT=" loglog(x,y)"
     ENDIF
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ."vhist") THEN
     TEMPTEXT=' hist(x,y,orientation="vertical")'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ."hhist") THEN
     TEMPTEXT=' hist(x,y,orientation="horizontal")'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(TRIM(GA(1)).EQ."bar") THEN
     TEMPTEXT=" bar(x,y)"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
   IF(GID.EQ.1.AND.YYAXES.NE.5) THEN
    IF(PNG.EQ.0.AND.DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm -r "//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".*')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(PNG.EQ.0.AND.NFPS.NE.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".png')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".dat')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
    TEMPTEXT=" hold"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
   END IF
   TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
  ELSEIF(N.EQ.1) THEN
   IF(YYAxes.EQ.1) THEN
    IF(DPI.NE.0) THEN
     TEMPTEXT1=" fig=figure("//TRIM(vMIN)//",dpi="//TRIM(vMAX)
     TEMPTEXT2=",figsize=(17,12))"
    ELSE
     TEMPTEXT1=" fig=figure("//TRIM(vMIN)
     TEMPTEXT2=",figsize=(17,12))"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" GHost=subplot("//TRIM(vMIN)
    IF(GAN.GE.25.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='" //TRIM(GA(27))//"')"
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT1)//")"
    ENDIF
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p0,=GHost.plot(x1,y1,""b-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.2.AND.TRIM(GA(2)).NE."") THEN
     TEMPTEXT5=' GHost.set_title("' // TRIM(GA(2)) // '"'
     IF(GAN.GE.3.AND.TRIM(GA(3)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(3))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ')'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
    IF(GAN.GE.4.AND.TRIM(GA(4)).NE."") THEN
     TEMPTEXT5=' GHost.set_xlabel("' // TRIM(GA(4)) // '"'
     IF(GAN.GE.5.AND.TRIM(GA(5)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(5))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',va="top")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' GHost.set_ylabel("' // TRIM(GA(6)) // '"'
     IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" GHost.yaxis.label.set_color(p0.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.10.AND.TRIM(GA(10)).NE."") THEN
     TEMPTEXT=' GHost.set_xlim'//TRIM(GA(10))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' GHost.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    RETURN
   ELSEIF(YYAxes.EQ.2) THEN
    TEMPTEXT=" par1 = GHost.twinx()"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p1,=par1.plot(x2,y2,""g-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" make_patch_spines_invisible(par1)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" par1.spines['right'].set_position(('axes', 1.05))"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" par1.spines['right'].set_visible(True)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' par1.set_ylabel("' // TRIM(GA(6)) // '"'
     IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" par1.yaxis.label.set_color(p1.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' par1.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    WRITE(101,*) ""
    RETURN
   ELSEIF(YYAxes.EQ.3) THEN
    TEMPTEXT=" par2 = GHost.twinx()"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" p2,=par2.plot(x3,y3,""r-"")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
     TEMPTEXT5=' par2.set_ylabel("' // TRIM(GA(6)) // '"'
     IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))//")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
     TEMPTEXT=" par2.yaxis.label.set_color(p2.get_color())"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
     TEMPTEXT=' par2.set_ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ELSE
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    WRITE(vMIN,'(I3)') SG
    TEMPTEXT1=" ax=fig.add_subplot("//TRIM(vMIN)
    IF(GAN.EQ.27.AND.GA(27).NE."") THEN
     TEMPTEXT2=",axisbg='"//TRIM(GA(27))//"'"
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
    TEMPTEXT5=""
    IF(TRIM(GA(1)).EQ."plot".OR.TRIM(GA(1)).EQ."") THEN
     TEMPTEXT1=" plot(x,y"
     IF(GAN.GE.20.AND.TRIM(GA(20)).NE."") THEN
      TEMPTEXT5=",label='" // TRIM(GA(20)) // "'"
     ENDIF
     IF(GAN.GE.21.AND.TRIM(GA(21)).NE."") THEN
      TEMPTEXT2=",'" // TRIM(GA(21)) // "'"
     ENDIF
     IF(GAN.GE.22.AND.TRIM(GA(22)).NE."") THEN
      TEMPTEXT3=",linewidth=" // TRIM(GA(22))
     ENDIF
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT5)//')'
    ELSEIF(TRIM(GA(1)).EQ."scatter") THEN
     TEMPTEXT=' scatter(x,y)'
    ELSEIF(TRIM(GA(1)).EQ.'semilog') THEN
     TEMPTEXT=" semilogy(x,y)"
    ELSEIF(TRIM(GA(1)).EQ."loglog") THEN
     IF(GAN.GE.20.AND.TRIM(GA(20)).NE."") THEN
      TEMPTEXT=" loglog(x,y,label='" // TRIM(GA(20)) // "')"
     ELSE
      TEMPTEXT=" loglog(x,y)"
     ENDIF
    ELSEIF(TRIM(GA(1)).EQ."vhist") THEN
     TEMPTEXT=' hist(x,y,orientation="vertical")'
    ELSEIF(TRIM(GA(1)).EQ."hhist") THEN
     TEMPTEXT=' hist(x,y,orientation="horizontal")'
    ELSEIF(TRIM(GA(1)).EQ."bar") THEN
     TEMPTEXT=" bar(x,y)"
    ENDIF
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
   IF(GID.EQ.1.AND.YYAXES.NE.5) THEN
    IF(PNG.EQ.0.AND.DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm -r "//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".*')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(PNG.EQ.0.AND.NFPS.NE.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".png')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSEIF(DF.EQ.0) THEN
     TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".dat')"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    END IF
    TEMPTEXT=" hold"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
!   WRITE(101,*) ""
   END IF
   TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT=""
  END IF

  IF((GID.EQ.0.OR.SG.NE.111).AND.YYAXES.NE.3) THEN
!  TITLE
   IF(GAN.GE.2.AND.TRIM(GA(2)).NE."") THEN
    TEMPTEXT5=' title("' // TRIM(GA(2)) // '"'
    IF(GAN.GE.3.AND.TRIM(GA(3)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(3))// ")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT5) // ')'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  X-LABEL
   IF(GAN.GE.4.AND.TRIM(GA(4)).NE."") THEN
    TEMPTEXT5=' xlabel("' // TRIM(GA(4)) // '"'
    IF(GAN.GE.5.AND.TRIM(GA(5)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(5)) // ")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT5) // ',va="top")'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  Y-LABEL
   IF(GAN.GE.6.AND.TRIM(GA(6)).NE."") THEN
    TEMPTEXT5=' ylabel("' // TRIM(GA(6)) // '"'
    IF(GAN.GE.7.AND.TRIM(GA(7)).NE."") THEN
     TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(7))// ")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=TRIM(TEMPTEXT5) // ',ha="right")'
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  Z-LABEL
   IF(N.EQ.3.AND.FLAG3D.EQ.1) THEN
    IF(GAN.GE.8.AND.TRIM(GA(8)).NE."") THEN
     TEMPTEXT5=' ax.set_zlabel("' // TRIM(GA(8)) // '"'
     IF(GAN.GE.9.AND.TRIM(GA(9)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(9))// ")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ')'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
   ENDIF
!  X-LIMIT
   IF(GAN.GE.10.AND.TRIM(GA(10)).NE."") THEN
    IF(N.EQ.3.AND.FLAG3D.EQ.1) THEN
     TEMPTEXT=' xlim3d'//TRIM(GA(10))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=' xlim'//TRIM(GA(10))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  Y-LIMIT
   IF(GAN.GE.11.AND.TRIM(GA(11)).NE."") THEN
    IF(N.EQ.3.AND.FLAG3D.EQ.1) THEN
     TEMPTEXT=' ylim3d'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ELSE
     TEMPTEXT=' ylim'//TRIM(GA(11))
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  Z-LIMIT
   IF(N.EQ.3.AND.FLAG3D.EQ.1.AND.GAN.GE.12.AND.TRIM(GA(12)).NE."") THEN
    TEMPTEXT=' ax.set_zlim3d'//TRIM(GA(12))
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  X-SCALE
   IF(GAN.GE.13.AND.TRIM(GA(13)).NE."") THEN
    TEMPTEXT=' xscale("'//TRIM(GA(13))//'")'
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Y-SCALE
   IF(GAN.GE.14.AND.TRIM(GA(14)).NE."") THEN
    TEMPTEXT=' yscale("'//TRIM(GA(14))//'")'
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Z-SCALE
   IF(GAN.GE.15.AND.TRIM(GA(15)).NE."") THEN
    TEMPTEXT=' zscale("'//TRIM(GA(15))//'")'
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  GRID
   IF(GAN.GE.16.AND.TRIM(GA(16)).EQ."".OR.TRIM(GA(16)).EQ."yes") THEN
    IF(FLAG3D.NE.1) TEMPTEXT=' grid(True)'
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  SUPER TITLE
   IF(GID.EQ.0) THEN
    IF(GAN.GE.17.AND.TRIM(GA(17)).NE."") THEN
     TEMPTEXT5=' suptitle("' // TRIM(GA(17)) // '"'
     IF(GAN.GE.18.AND.TRIM(GA(18)).NE."") THEN
      TEMPTEXT=TRIM(TEMPTEXT5)//",fontsize="//TRIM(GA(18))// ")"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ELSE
      TEMPTEXT=TRIM(TEMPTEXT5) // ')'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
   END IF
   TEMPTEXT="";TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""
!  LEGEND
   IF(GAN.GE.23.AND.TRIM(GA(23)).NE."") THEN
    TEMPTEXT1=' leg=legend('
    IF(GAN.GE.24.AND.TRIM(GA(24)).NE."") THEN
     TEMPTEXT5="loc='"//TRIM(GA(24))//"',labelspacing=0.05"//",handlelength=3"
    ENDIF
    IF(GAN.GE.26.AND.TRIM(GA(26)).NE."") THEN
     TEMPTEXT2=",ncol="//TRIM(GA(26))
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT5)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT1=" legtext=leg.get_texts()"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT1))))) TRIM(TEMPTEXT1)
    IF(GAN.GE.25.AND.TRIM(GA(25)).NE."") THEN
     TEMPTEXT1=" setp(legtext,fontsize="//TRIM(GA(25))//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT1))))) TRIM(TEMPTEXT1)
    ELSE
     TEMPTEXT1=" setp(legtext,fontsize=9)"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT1))))) TRIM(TEMPTEXT1)
    ENDIF
    TEMPTEXT="";TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""
   ENDIF
!  COLOR BAR
   IF(GAN.GE.68.AND.TRIM(GA(68)).NE."") THEN
    TEMPTEXT=" cbarticks="//TRIM(GA(68))
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   END IF
   IF(GAN.GE.33.AND.TRIM(GA(33)).EQ."yes") THEN
    TEMPTEXT1=" cbar=pltpng.colorbar(cset1"
    IF((GAN.GE.65.AND.TRIM(GA(65)).NE."").OR.(GAN.GE.68.AND.TRIM(GA(68)).NE."")) THEN
     TEMPTEXT2=",ticks=cbarticks"
    ELSE
     TEMPTEXT2=""
    END IF
    TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
    IF(GAN.GE.34.AND.TRIM(GA(34)).NE."") THEN
     TEMPTEXT1=",orientation='"//TRIM(GA(34))//"'"
    ELSE
     TEMPTEXT1=",orientation='vertical'"
    ENDIF
    IF(GAN.GE.35.AND.TRIM(GA(35)).NE."") THEN
     TEMPTEXT2=",shrink="//TRIM(GA(35))
    ELSE
     TEMPTEXT2=""
    ENDIF
    TEMPTEXT=TRIM(TEMPTEXT)//TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    IF(GAN.GE.36.AND.TRIM(GA(36)).NE."") THEN
     TEMPTEXT=" cbar.ax.tick_params(labelsize="//TRIM(GA(36))//")"
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
    IF(GAN.GE.37.AND.TRIM(GA(37)).NE."") THEN
     TEMPTEXT1=" cbar.set_label(r'"//TRIM(GA(37))//"'"
     IF(GAN.GE.38.AND.TRIM(GA(38)).NE."") THEN
      TEMPTEXT2=",size="//TRIM(GA(38))//")"
     ELSE
      TEMPTEXT2=")"
     ENDIF
     TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
     WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    ENDIF
   ENDIF
!  X-TICKS FONTSIZE
   IF(GAN.GE.39.AND.TRIM(GA(39)).NE."") THEN
    TEMPTEXT=" for tick in ax.xaxis.get_major_ticks():"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT="     tick.label1.set_fontsize("//TRIM(GA(39))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Y-TICKS FONTSIZE
   IF(GAN.GE.40.AND.TRIM(GA(40)).NE."") THEN
    TEMPTEXT=" for tick in ax.yaxis.get_major_ticks():"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT="     tick.label1.set_fontsize("//TRIM(GA(40))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  X-TICKS NUMBERS FORMAT
   IF(GAN.GE.41.AND.TRIM(GA(41)).NE."") THEN
    TEMPTEXT=" xfmt=FormatStrFormatter('%"//TRIM(GA(41))//"')"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" gca().xaxis.set_major_formatter(xfmt)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Y-TICKS NUMBER FORMAT
   IF(GAN.GE.42.AND.TRIM(GA(42)).NE."") THEN
    TEMPTEXT=" yfmt=FormatStrFormatter('%"//TRIM(GA(42))//"')"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" gca().yaxis.set_major_formatter(yfmt)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  X-TICKS NUMBER LOCATOR
   IF(GAN.GE.43.AND.TRIM(GA(43)).NE."") THEN
    TEMPTEXT=" xloc=MultipleLocator("//TRIM(GA(43))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" gca().xaxis.set_major_locator(xloc)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Y-TICKS NUMBER LOCATOR
   IF(GAN.GE.44.AND.TRIM(GA(44)).NE."") THEN
    TEMPTEXT=" yloc=MultipleLocator("//TRIM(GA(44))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
    TEMPTEXT=" gca().yaxis.set_major_locator(yloc)"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  X-TICKS NUMBER ROTATION
   IF(GAN.GE.45.AND.TRIM(GA(45)).NE."") THEN
    TEMPTEXT=" xticks(rotation='"//TRIM(GA(45))//"')"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  Y-TICKS NUMBER ROTATION
   IF(GAN.GE.46.AND.TRIM(GA(46)).NE."") THEN
    TEMPTEXT=" yticks(rotation="//TRIM(GA(46))//")"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   ENDIF
!  TEXTS AND ANNOTATE ONLY FOR 2D PLOTS
   IF(N.NE.3) THEN
!  TEXT
     IF(GAN.GE.51.AND.TRIM(GA(51)).NE."") THEN
      TEMPTEXT=" tex='" // TRIM(GA(51)) // "'"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
      IF(GAN.GE.45.AND.TRIM(GA(53)).NE."") THEN
       TEMPTEXT2=TRIM(GA(53))
      ELSE
       TEMPTEXT2="10"
      ENDIF
      IF(GAN.GE.52.AND.TRIM(GA(52)).NE."") THEN
       TEMPTEXT1=TRIM(GA(52))
      ELSE
       TEMPTEXT1="(0,0)"
      ENDIF
      FNL=LEN(TRIM(TEMPTEXT1))
      IF(GAN.GE.54.AND.TRIM(GA(54)).NE."") THEN
       TEMPTEXT3=TRIM(GA(54))
      ELSE
       TEMPTEXT3="k"
      ENDIF
      TEMPTEXT=' text'//TEMPTEXT1(1:FNL-1)// ', tex, fontsize='//TRIM(TEMPTEXT2) &
              &     // ', color="' // TRIM(TEMPTEXT3) //'"'//', va="center",ha="center")'
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
!  ANNOTATE
     IF(GAN.GE.56.AND.TRIM(GA(56)).NE."") THEN
      TEMPTEXT=" tex='" // TRIM(GA(56)) // "'"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
      IF(GAN.GE.59.AND.TRIM(GA(59)).NE."") THEN
       TEMPTEXT3=TRIM(GA(59))
      ELSE
       TEMPTEXT3="10"
      ENDIF
      IF(GAN.GE.60.AND.TRIM(GA(60)).NE."") THEN
       TEMPTEXT4=TRIM(GA(60))
      ELSE
       TEMPTEXT4="'k'"
      ENDIF
      TEMPTEXT1=TRIM(GA(57))
      TEMPTEXT2=TRIM(GA(58))
      TEMPTEXT=' annotate(tex,xy='//TRIM(TEMPTEXT2)//',xytext='//TRIM(TEMPTEXT1)    &
              &                 // ', fontsize=' // TRIM(TEMPTEXT3)                &
              &                //",arrowprops=dict(facecolor='" // TRIM(TEMPTEXT4) &
              &               //"',shrink=0.01),ha='center',va='center')"
      WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
     ENDIF
    ENDIF
   ENDIF
  END IF

  IF(PRESENT(GX)) THEN
   DO I=1,SIZE(GX)
    IF(GX(I).NE."") THEN
    WRITE(101,TRIM(STRFMT(1+LEN(TRIM(GX(I)))))) " "//TRIM(GX(I))
    END IF
   END DO
  END IF

  IF((PNG.NE.0.OR.NFPS.NE.0).AND.GID.NE.1) THEN
   FNL=LEN_TRIM(AUTONAME)
   TEMPTEXT1=" pltpng.savefig('./"
   TEMPTEXT2=AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//"')"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  END IF

  IF(PDF.NE.0.AND.GID.NE.1) THEN
   IF((DPI/100).GE.1) THEN
    WRITE(vMAX,'(I3)') DPI
   ELSEIF((DPI/10).GE.1) THEN
    WRITE(vMAX,'(I2)') DPI
   ELSEIF(DPI.GE.1) THEN
    WRITE(vMAX,'(I1)') DPI
   ENDIF
   TEMPTEXT=" pp.savefig(fig,dpi="//TRIM(vMAX)//")"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  END IF

  IF((PNG.EQ.0.AND.DF.EQ.0).AND.GID.NE.1) THEN
   TEMPTEXT=" os.system('rm -r "//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".*')"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  ELSEIF((PNG.EQ.0.AND.NFPS.NE.0).AND.GID.NE.1) THEN
   TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".png')"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  ELSEIF(DF.EQ.0.AND.GID.NE.1) THEN
   TEMPTEXT=" os.system('rm ./"//AUTONAME(1:FNL-8)//"/"//AUTONAME(1:FNL-4)//".dat')"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  END IF

  TEMPTEXT="except IOError:"
  WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  TEMPTEXT=" print 'IOERROR: FILE ("//TRIM(AUTONAME)//") NOT FOUND'"
  WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  TEMPTEXT=""
  WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  TEMPTEXT=""
  WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  TEMPTEXT=""
  WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)

  IF(PDF.NE.0.AND.GID.NE.1) THEN
   TEMPTEXT="pp.close()"
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  ELSE
   WRITE(101,*) ""
  END IF

  TEMPTEXT1="";TEMPTEXT2="";TEMPTEXT3="";TEMPTEXT4="";TEMPTEXT5=""

  IF(PDF.NE.0.AND.GID.NE.1) THEN
   TEMPTEXT1="os.system('mv "//AUTONAME(1:FNL-8)//".pdf ./"
   TEMPTEXT2=AUTONAME(1:FNL-8)//"/.')"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  ELSE
   WRITE(101,*) ""
  END IF

  IF(NFPS.NE.0.AND.GID.NE.1) THEN
   IF((NFPS/100).GE.1) THEN
    WRITE(vMAX,'(I3)') NFPS
   ELSEIF((NFPS/10).GE.1) THEN
    WRITE(vMAX,'(I2)') NFPS
   ELSEIF(NFPS.GE.1) THEN
    WRITE(vMAX,'(I1)') NFPS
   ENDIF
   TEMPTEXT1="os.system('mencoder ''mf://"//AUTONAME(1:FNL-8)
   TEMPTEXT2="/*.png'' -mf type=png:fps="//vMax
   TEMPTEXT3=" -ovc lavc -lavcopts vcodec=wmv2 -oac copy -o "
   TEMPTEXT4=AUTONAME(1:FNL-8)//".mpg')"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)//TRIM(TEMPTEXT3)//TRIM(TEMPTEXT4)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
   TEMPTEXT1=" os.system('mv "//AUTONAME(1:FNL-8)//".mpg ./"
   TEMPTEXT2=AUTONAME(1:FNL-8)//"/.')"
   TEMPTEXT=TRIM(TEMPTEXT1)//TRIM(TEMPTEXT2)
   WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  ELSE
   WRITE(101,*) ""
  END IF


  IF(GID.NE.1) THEN
    TEMPTEXT="exit"
    WRITE(101,TRIM(STRFMT(LEN(TRIM(TEMPTEXT))))) TRIM(TEMPTEXT)
  END IF

  WRITE(101,*) ""
  CLOSE(101)

  RETURN
 END SUBROUTINE DOTPY



! FUNCTION TO CREATE THE NAMES OF THE DATAFILES OF A CERTAIN GROUP IN ORDER

 FUNCTION GETFNAME(PART1,NUM)
  IMPLICIT NONE
  CHARACTER(len=*) :: PART1
  CHARACTER*4 :: part2 = '.dat'
  CHARACTER*4 :: fnum
  CHARACTER*25 :: GETFNAME
  INTEGER :: div1Val,div10Val,div100Val,div1000Val
  INTEGER :: mod100Val,mod1000Val
  INTEGER :: NUM

  PART2=".dat"   
  IF (NUM.GE.1000) THEN
   div1000Val = NUM/1000
   mod1000Val = mod(NUM,1000)
   div100Val = mod1000Val/100
   mod100Val = mod(mod1000Val,100)
   div10Val = mod100Val/10
   div1Val = mod(mod100Val,10)
  ELSE IF (NUM.GE.100) THEN
   div1000Val = 0
   div100Val = NUM/100
   mod100Val = mod(NUM,100)
   div10Val = mod100Val/10
   div1Val = mod(mod100Val,10)
  ELSE IF (NUM.GE.10) THEN
   div1000Val = 0
   div100Val = 0
   div10Val = NUM/10
   div1Val = mod(NUM,10)
  ELSE
   div1000Val = 0
   div100Val = 0
   div10Val = 0
   div1Val  = mod(NUM,10)
  END IF
  FNUM=char(div1000Val+48)//char(div100Val+48)//char(div10Val+48)//char(div1Val+48)
  GETFNAME = part1//fnum//part2

  RETURN
 END FUNCTION GETFNAME

! FUNCTION GIVES YOU THE CORRESPONDING NUMBER OF SOME PROPERTIES
! USED IN THE GFC ARRAY THAT YOU PASS AS AN ARGUMENT TO THE 
! FORTPLOT SUBROUTINE.
 FUNCTION GETVALOF(FP)
  IMPLICIT NONE
  CHARACTER(*), INTENT(IN) :: FP
  INTEGER(4)               :: GETVALOF

  SELECT CASE (TRIM(FP))
   CASE ("NO")
    GETVALOF=0
   CASE ("no")
    GETVALOF=0
   CASE ("REMOVE")
    GETVALOF=0
   CASE ("remove")
    GETVALOF=0
   CASE ("DELETE")
    GETVALOF=0
   CASE ("delete")
    GETVALOF=0
   CASE ("YES")
    GETVALOF=1
   CASE ("yes")
    GETVALOF=1
   CASE ("KEEP")
    GETVALOF=1
   CASE ("keep")
    GETVALOF=1
   CASE ("SAVE")
    GETVALOF=1
   CASE ("save")
    GETVALOF=1
   CASE ("UNFORMATTED")
    GETVALOF=2
   CASE ("unformatted")
    GETVALOF=2
   CASE ("FORMATTED")
    GETVALOF=1
   CASE ("formatted")
    GETVALOF=1
  END SELECT

  RETURN
 END FUNCTION GETVALOF


! FUNCTION CAN BE USED TO GIVE THE FORMAT OF A TEXT OF CERTAIN LENGTH.
! YOU CAN GO OVER THE CODE TO CHECK HOW CAN YOU USE IT.
 FUNCTION STRFMT(NUM)
  IMPLICIT NONE

  CHARACTER*3 ::NUMCHAR
  CHARACTER*6 ::STRFMT
  INTEGER(4)  ::NUM,div100,mod100,div10,div1
      
  IF (NUM.GE.100) THEN
   div100 = NUM/100
   mod100 = mod(NUM,100)
   div10 = mod100/10
   div1 = mod(mod100,10)
   NUMCHAR = char(div100+48)//char(div10+48)//char(div1+48)
  ELSE IF (NUM.GE.10) THEN
   div100 = 0
   div10 = NUM/10
   div1 = mod(NUM,10)
   NUMCHAR = char(div10+48)//char(div1+48)
  ELSE
   div1  = mod(NUM,10)
   IF(div1.EQ.0) div1=1
   NUMCHAR = char(div1+48)
  END IF

  STRFMT='(A'//TRIM(NUMCHAR)//')'

  RETURN
 END FUNCTION STRFMT

 FUNCTION I4NUM2STR(NUM)
  IMPLICIT NONE
  CHARACTER(10) :: I4NUM2STR
  INTEGER(4)    :: NUM

  IF((NUM/1000000000).GE.1) THEN
   WRITE(I4NUM2STR,'(I10)') NUM
  ELSEIF((NUM/100000000).GE.1) THEN
   WRITE(I4NUM2STR,'(I9)') NUM
  ELSEIF((NUM/10000000).GE.1) THEN
   WRITE(I4NUM2STR,'(I8)') NUM
  ELSEIF((NUM/1000000).GE.1) THEN
   WRITE(I4NUM2STR,'(I7)') NUM
  ELSEIF((NUM/100000).GE.1) THEN
   WRITE(I4NUM2STR,'(I6)') NUM
  ELSEIF((NUM/10000).GE.1) THEN
   WRITE(I4NUM2STR,'(I5)') NUM
  ELSEIF((NUM/1000).GE.1) THEN
   WRITE(I4NUM2STR,'(I4)') NUM
  ELSEIF((NUM/100).GE.1) THEN
   WRITE(I4NUM2STR,'(I3)') NUM
  ELSEIF((NUM/10).GE.1) THEN
   WRITE(I4NUM2STR,'(I2)') NUM
  ELSE
   WRITE(I4NUM2STR,'(I1)') NUM
  ENDIF

  RETURN
 END FUNCTION I4NUM2STR

END MODULE FORTGRAPHER
